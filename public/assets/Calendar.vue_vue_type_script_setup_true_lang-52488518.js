import{a as Ne,r as re,u as ye,b as Be,e as Y,p as ze,g as he,d as de,o as c,f as v,c as P,w as g,h as O,V as ae,i as Ue,F as H,j as R,k as ee,l as j,t as T,m as _e,n as _,q as S,s as qe,v as K,x as f,y as L,z as B,A as ge,B as q,C as Ke,T as oe,D as me,E as Xe,G as fe,H as Ee,_ as w,I as xe,J as Ge,K as $e,L as Ze,M as Je,N as He,O as pe,P as ue,Q as z,R as Qe,S as le,U as be,W as We,X as ke,Y as te,Z as ce,$ as et,a0 as tt,a1 as Te,a2 as Ce,a3 as it,a4 as st,a5 as nt,a6 as at,a7 as lt}from'./index-fe8b870b.js';const De=Ne('calendar',()=>{const e=re({activityIds:[],focusedEvent:void 0,focusedCell:void 0,loading:!0,clipboard:void 0}),t=ye(),i=Be(),n=Y(()=>e.value.loading),l=Y(()=>!!e.value.newEvent),s=Y(()=>e.value.focusedEvent),r=Y(()=>e.value.clipboard),a=Y(()=>e.value.focusedCell),d=Y(()=>{if(!e.value.startTime||!e.value.endTime)return[];const p=ze(t.list.filter(E=>e.value.activityIds.includes(E._id)),e.value.startTime,e.value.endTime,i.activityId);return e.value.newEvent&&p.push(e.value.newEvent),p;}),o=(p,E)=>(e.value.startTime=p,e.value.endTime=E,t.find({selector:{eventFirstStart:{$lte:he(e.value.endTime)},eventLastEnd:{$gte:he(e.value.startTime)}}}).then(F=>(e.value.activityIds=F?F.map(Z=>Z._id):[],e.value.activityIds))),u=p=>{e.value.activityIds.includes(p)||e.value.activityIds.push(p);};return{state:e,isLoading:n,events:d,focusedEvent:s,focusedCell:a,clipboard:r,load:o,hasNewEvent:l,addActivityId:u,addNewEvent:p=>{e.value.newEvent=p,p.id&&u(p.id);},removeNewEvent:()=>{e.value.newEvent=void 0;},focusEvent:p=>{e.value.focusedEvent=d.value.find(E=>E.eventId===p);},unfocusEvent:()=>{e.value.focusedEvent=void 0;},focusCell:p=>{e.value.focusedCell=p;},unfocusCell:()=>{e.value.focusedCell=void 0;},addToClipboard:(p,E,F)=>{e.value.clipboard={activityId:p,eventId:E,type:F};},removeFromClipboard:()=>{e.value.clipboard=void 0;}};}),Le=['years','year','month','week','day'],Ie='week',Me='day',rt={class:'m-0 text-subtitle-2 text-md-h6'},ot=de({__name:'CalendarHeader',props:{vuecal:{type:Object,default:void 0},activeView:{type:String,default:Ie},views:{type:Array,default:()=>[]}},emits:['update:activeView','addEvent'],setup(e,{emit:t}){const i=e,n=Y(()=>{if(!i.vuecal)return'';const a={year:'numeric'};return i.activeView==='month'||i.activeView==='week'?a.month='long':i.activeView==='day'&&(a.month='long',a.day='numeric'),i.vuecal.view.startDate.toLocaleDateString(void 0,a);}),l=()=>{i.vuecal&&i.vuecal.previous();},s=()=>{i.vuecal&&i.vuecal.next();},r=()=>{i.vuecal&&i.vuecal.switchView(i.activeView,new Date);};return(a,d)=>(c(),v(H,null,[i.vuecal?(c(),P(_e,{key:0,class:'pb-0 pt-2 px-2'},{default:g(()=>[O(ae,{cols:'9',md:6,'offset-md':3,class:'d-flex flex-column align-start align-md-center justify-center pa-0'},{default:g(()=>[O(Ue,{'model-value':i.activeView,rounded:'0',group:'',density:'compact',class:'calendar-header__toggle','onUpdate:modelValue':d[0]||(d[0]=o=>t('update:activeView',o))},{default:g(()=>[(c(!0),v(H,null,R(i.views,o=>(c(),P(ee,{key:o,value:o},{default:g(()=>[j(T(o),1)]),_:2},1032,['value']))),128))]),_:1},8,['model-value'])]),_:1}),O(ae,{cols:'3',class:'d-flex flex-column align-end pa-0'},{default:g(()=>[O(ee,{icon:'mdi-plus',variant:'text',onClick:d[1]||(d[1]=o=>t('addEvent'))})]),_:1})]),_:1})):_('',!0),O(_e,{class:'pb-4 px-2'},{default:g(()=>[O(ae,{cols:'6',class:'d-flex align-center pa-0'},{default:g(()=>[S('h2',rt,T(n.value),1)]),_:1}),O(ae,{cols:'6',class:'d-flex align-center pa-0'},{default:g(()=>[O(qe),O(ee,{icon:'mdi-arrow-left',variant:'text',onClick:l}),O(ee,{icon:'mdi-calendar-today',variant:'text',onClick:r}),O(ee,{icon:'mdi-arrow-right',variant:'text',onClick:s})]),_:1})]),_:1})],64));}});var we=(e=>(e.Copy='copy',e.Cut='cut',e))(we||{}),dt=Object.defineProperty,ut=(e,t,i)=>t in e?dt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,U=(e,t,i)=>(ut(e,typeof t!='symbol'?t+'':t,i),i);/**
  * vue-cal v4.8.1
  * (c) 2022 Antoni Andre <antoniandre.web@gmail.com>
  * @license MIT
  */let ie,Se,Oe,N,se={},X={};class ct{constructor(t){U(this,'_vuecal',null),U(this,'selectCell',(i=!1,n,l)=>{this._vuecal.$emit('cell-click',l?{date:n,split:l}:n),this._vuecal.clickToNavigate||i?this._vuecal.switchToNarrowerView():this._vuecal.dblclickToNavigate&&'ontouchstart'in window&&(this._vuecal.domEvents.dblTapACell.taps++,setTimeout(()=>this._vuecal.domEvents.dblTapACell.taps=0,this._vuecal.domEvents.dblTapACell.timeout),this._vuecal.domEvents.dblTapACell.taps>=2&&(this._vuecal.domEvents.dblTapACell.taps=0,this._vuecal.switchToNarrowerView(),this._vuecal.$emit('cell-dblclick',l?{date:n,split:l}:n)));}),U(this,'keyPressEnterCell',(i,n)=>{this._vuecal.$emit('cell-keypress-enter',n?{date:i,split:n}:i),this._vuecal.switchToNarrowerView();}),U(this,'getPosition',i=>{const{left:n,top:l}=this._vuecal.cellsEl.getBoundingClientRect(),{clientX:s,clientY:r}='ontouchstart'in window&&i.touches?i.touches[0]:i;return{x:s-n,y:r-l};}),U(this,'minutesAtCursor',i=>{let n=0,l={x:0,y:0};const{timeStep:s,timeCellHeight:r,timeFrom:a}=this._vuecal.$props;return typeof i=='number'?n=i:typeof i=='object'&&(l=this.getPosition(i),n=Math.round(l.y*s/parseInt(r)+a)),{minutes:Math.max(Math.min(n,1440),0),cursorCoords:l};}),this._vuecal=t;}}let C,M,ve;class vt{constructor(t,i){U(this,'_vuecal',null),U(this,'eventDefaults',{_eid:null,start:'',startTimeMinutes:0,end:'',endTimeMinutes:0,title:'',content:'',background:!1,allDay:!1,segments:null,repeat:null,daysCount:1,deletable:!0,deleting:!1,titleEditable:!0,resizable:!0,resizing:!1,draggable:!0,dragging:!1,draggingStatic:!1,focused:!1,class:''}),this._vuecal=t,C=i;}createAnEvent(t,i,n){if(typeof t=='string'&&(t=C.stringToDate(t)),!(t instanceof Date))return!1;const l=C.dateToMinutes(t),s=l+(i=1*i||120),r=C.addMinutes(new Date(t),i);n.end&&(typeof n.end=='string'&&(n.end=C.stringToDate(n.end)),n.endTimeMinutes=C.dateToMinutes(n.end));const a={...this.eventDefaults,_eid:`${this._vuecal._.uid}_${this._vuecal.eventIdIncrement++}`,start:t,startTimeMinutes:l,end:r,endTimeMinutes:s,segments:null,...n};return typeof this._vuecal.onEventCreate!='function'||this._vuecal.onEventCreate(a,()=>this.deleteAnEvent(a))?(a.startDateF!==a.endDateF&&(a.daysCount=C.countDays(a.start,a.end)),this._vuecal.mutableEvents.push(a),this._vuecal.addEventsToView([a]),this._vuecal.emitWithEvent('event-create',a),this._vuecal.$emit('event-change',{event:this._vuecal.cleanupEvent(a),originalEvent:null}),a):void 0;}addEventSegment(t){t.segments||(t.segments={},t.segments[C.formatDateLite(t.start)]={start:t.start,startTimeMinutes:t.startTimeMinutes,endTimeMinutes:1440,isFirstDay:!0,isLastDay:!1});const i=t.segments[C.formatDateLite(t.end)];i&&(i.isLastDay=!1,i.endTimeMinutes=1440);const n=C.addDays(t.end,1),l=C.formatDateLite(n);return n.setHours(0,0,0,0),t.segments[l]={start:n,startTimeMinutes:0,endTimeMinutes:t.endTimeMinutes,isFirstDay:!1,isLastDay:!0},t.end=C.addMinutes(n,t.endTimeMinutes),t.daysCount=Object.keys(t.segments).length,l;}removeEventSegment(t){let i=Object.keys(t.segments).length;if(i<=1)return C.formatDateLite(t.end);delete t.segments[C.formatDateLite(t.end)],i--;const n=C.subtractDays(t.end,1),l=C.formatDateLite(n),s=t.segments[l];return i?s&&(s.isLastDay=!0,s.endTimeMinutes=t.endTimeMinutes):t.segments=null,t.daysCount=i||1,t.end=n,l;}createEventSegments(t,i,n){const l=i.getTime(),s=n.getTime();let r,a,d,o=t.start.getTime(),u=t.end.getTime(),y=!1;for(t.end.getHours()||t.end.getMinutes()||(u-=1e3),t.segments={},t.repeat?(r=l,a=Math.min(s,t.repeat.until?C.stringToDate(t.repeat.until).getTime():s)):(r=Math.max(l,o),a=Math.min(s,u));r<=a;){let D=!1;const A=C.addDays(new Date(r),1).setHours(0,0,0,0);let k,W,I,x;if(t.repeat){const m=new Date(r),p=C.formatDateLite(m);(y||t.occurrences&&t.occurrences[p])&&(y||(o=t.occurrences[p].start,d=new Date(o).setHours(0,0,0,0),u=t.occurrences[p].end),y=!0,D=!0),k=r===d,W=p===C.formatDateLite(new Date(u)),I=new Date(k?o:r),x=C.formatDateLite(I),W&&(y=!1);}else D=!0,k=r===o,W=a===u&&A>a,I=k?t.start:new Date(r),x=C.formatDateLite(k?t.start:I);D&&(t.segments[x]={start:I,startTimeMinutes:k?t.startTimeMinutes:0,endTimeMinutes:W?t.endTimeMinutes:1440,isFirstDay:k,isLastDay:W}),r=A;}return t;}deleteAnEvent(t){this._vuecal.emitWithEvent('event-delete',t),this._vuecal.mutableEvents=this._vuecal.mutableEvents.filter(i=>i._eid!==t._eid),this._vuecal.view.events=this._vuecal.view.events.filter(i=>i._eid!==t._eid);}checkCellOverlappingEvents(t,i){ve=t.slice(0),M={},t.forEach(l=>{ve.shift(),M[l._eid]||(M[l._eid]={overlaps:[],start:l.start,position:0}),M[l._eid].position=0,ve.forEach(s=>{M[s._eid]||(M[s._eid]={overlaps:[],start:s.start,position:0});const r=this.eventInRange(s,l.start,l.end),a=i.overlapsPerTimeStep?C.datesInSameTimeStep(l.start,s.start,i.timeStep):1;if(l.background||l.allDay||s.background||s.allDay||!r||!a){let d,o;(d=(M[l._eid]||{overlaps:[]}).overlaps.indexOf(s._eid))>-1&&M[l._eid].overlaps.splice(d,1),(o=(M[s._eid]||{overlaps:[]}).overlaps.indexOf(l._eid))>-1&&M[s._eid].overlaps.splice(o,1),M[s._eid].position--;}else M[l._eid].overlaps.push(s._eid),M[l._eid].overlaps=[...new Set(M[l._eid].overlaps)],M[s._eid].overlaps.push(l._eid),M[s._eid].overlaps=[...new Set(M[s._eid].overlaps)],M[s._eid].position++;});});let n=0;for(const l in M){const s=M[l],r=s.overlaps.map(a=>({id:a,start:M[a].start}));r.push({id:l,start:s.start}),r.sort((a,d)=>a.start<d.start?-1:a.start>d.start?1:a.id>d.id?-1:1),s.position=r.findIndex(a=>a.id===l),n=Math.max(this.getOverlapsStreak(s,M),n);}return[M,n];}getOverlapsStreak(t,i={}){let n=t.overlaps.length+1,l=[];return t.overlaps.forEach(s=>{l.includes(s)||t.overlaps.filter(r=>r!==s).forEach(r=>{i[r].overlaps.includes(s)||l.push(r);});}),l=[...new Set(l)],n-=l.length,n;}eventInRange(t,i,n){if(t.allDay||!this._vuecal.time){const r=new Date(t.start).setHours(0,0,0,0);return new Date(t.end).setHours(23,59,0,0)>=new Date(i).setHours(0,0,0,0)&&r<=new Date(n).setHours(0,0,0,0);}const l=t.start.getTime(),s=t.end.getTime();return l<n.getTime()&&s>i.getTime();}}const ht={class:'vuecal__flex vuecal__weekdays-headings'},mt=['onClick'],pt={class:'vuecal__flex weekday-label',grow:''},wt={class:'full'},yt={class:'small'},Dt={class:'xsmall'},_t={key:0},gt={key:0,class:'vuecal__flex vuecal__split-days-headers',grow:''},G=(e,t)=>{const i=e.__vccOpts||e;for(const[n,l]of t)i[n]=l;return i;},je=G({inject:['vuecal','utils','view'],props:{transitionDirection:{type:String,default:'right'},weekDays:{type:Array,default:()=>[]},switchToNarrowerView:{type:Function,default:()=>{}}},methods:{selectCell(e,t){e.getTime()!==this.view.selectedDate.getTime()&&(this.view.selectedDate=e),this.utils.cell.selectCell(!1,e,t);},cleanupHeading:e=>({label:e.full,date:e.date,...e.today?{today:e.today}:{}})},computed:{headings(){if(!['month','week'].includes(this.view.id))return[];let e=!1;return this.weekDays.map((t,i)=>{const n=this.utils.date.addDays(this.view.startDate,this.vuecal.startWeekOnSunday?i-1:i);return{hide:t.hide,full:t.label,small:t.short||t.label.substr(0,3),xsmall:t.short||t.label.substr(0,1),...this.view.id==='week'?{dayOfMonth:n.getDate(),date:n,today:!e&&this.utils.date.isToday(n)&&!e++}:{}};});},cellWidth(){return 100/(7-this.weekDays.reduce((e,t)=>e+t.hide,0));},weekdayCellStyles(){return{...this.vuecal.hideWeekdays.length?{width:`${this.cellWidth}%`}:{}};},cellHeadingsClickable(){return this.view.id==='week'&&(this.vuecal.clickToNavigate||this.vuecal.dblclickToNavigate);}}},[['render',function(e,t,i,n,l,s){return c(),v('div',ht,[(c(!0),v(H,null,R(s.headings,(r,a)=>(c(),v(H,{key:a},[r.hide?_('',!0):(c(),v('div',{key:0,class:L(['vuecal__flex vuecal__heading',{today:r.today,clickable:s.cellHeadingsClickable}]),style:B(s.weekdayCellStyles),onClick:d=>s.view.id==='week'&&s.selectCell(r.date,d),onDblclick:t[0]||(t[0]=d=>s.view.id==='week'&&s.vuecal.dblclickToNavigate&&i.switchToNarrowerView())},[O(oe,{name:`slide-fade--${i.transitionDirection}`,appear:s.vuecal.transitions},{default:g(()=>[(c(),v('div',{class:'vuecal__flex',column:'',key:!!s.vuecal.transitions&&`${a}-${r.dayOfMonth}`},[S('div',pt,[f(e.$slots,'weekday-heading',{heading:s.cleanupHeading(r),view:s.view},()=>[S('span',wt,T(r.full),1),S('span',yt,T(r.small),1),S('span',Dt,T(r.xsmall),1),r.dayOfMonth?(c(),v('span',_t,'Â '+T(r.dayOfMonth),1)):_('',!0)])]),s.vuecal.hasSplits&&s.vuecal.stickySplitLabels?(c(),v('div',gt,[(c(!0),v(H,null,R(s.vuecal.daySplits,(d,o)=>(c(),v('div',{class:L(['day-split-header',d.class||!1]),key:o},[f(e.$slots,'split-label',{split:d,view:s.view},()=>[j(T(d.label),1)])],2))),128))])):_('',!0)]))]),_:2},1032,['name','appear'])],46,mt))],64))),128))]);}]]),ft={class:'vuecal__header'},Et={key:0,class:'vuecal__flex vuecal__menu',role:'tablist','aria-label':'Calendar views navigation'},bt=['onDragenter','onDragleave','onClick','aria-label'],kt={key:1,class:'vuecal__title-bar'},Tt=['aria-label'],Ct={class:'vuecal__flex vuecal__title',grow:''},Mt=['aria-label'],St={key:0,class:'vuecal__flex vuecal__split-days-headers'},Ot=G({inject:['vuecal','previous','next','switchView','updateSelectedDate','modules','view'],components:{WeekdaysHeadings:je},props:{options:{type:Object,default:()=>({})},editEvents:{type:Object,required:!0},hasSplits:{type:[Boolean,Number],default:!1},daySplits:{type:Array,default:()=>[]},viewProps:{type:Object,default:()=>({})},weekDays:{type:Array,default:()=>[]},switchToNarrowerView:{type:Function,default:()=>{}}},data:()=>({highlightedControl:null}),methods:{goToToday(){this.updateSelectedDate(new Date(new Date().setHours(0,0,0,0)));},switchToBroaderView(){this.transitionDirection='left',this.broaderView&&this.switchView(this.broaderView);}},computed:{transitionDirection:{get(){return this.vuecal.transitionDirection;},set(e){this.vuecal.transitionDirection=e;}},broaderView(){const{enabledViews:e}=this.vuecal;return e[e.indexOf(this.view.id)-1];},showDaySplits(){return this.view.id==='day'&&this.hasSplits&&this.options.stickySplitLabels&&!this.options.minSplitWidth;},dnd(){return this.modules.dnd;}}},[['render',function(e,t,i,n,l,s){const r=q('weekdays-headings');return c(),v('div',ft,[i.options.hideViewSelector?_('',!0):(c(),v('div',Et,[(c(!0),v(H,null,R(i.viewProps.views,(a,d)=>(c(),v(H,{key:d},[a.enabled?(c(),v('button',{key:0,class:L(['vuecal__view-btn',{'vuecal__view-btn--active':s.view.id===d,'vuecal__view-btn--highlighted':e.highlightedControl===d}]),type:'button',onDragenter:o=>i.editEvents.drag&&s.dnd&&s.dnd.viewSelectorDragEnter(o,d,e.$data),onDragleave:o=>i.editEvents.drag&&s.dnd&&s.dnd.viewSelectorDragLeave(o,d,e.$data),onClick:o=>s.switchView(d,null,!0),'aria-label':`${a.label} view`},T(a.label),43,bt)):_('',!0)],64))),128))])),i.options.hideTitleBar?_('',!0):(c(),v('div',kt,[S('button',{class:L(['vuecal__arrow vuecal__arrow--prev',{'vuecal__arrow--highlighted':e.highlightedControl==='previous'}]),type:'button',onClick:t[0]||(t[0]=(...a)=>s.previous&&s.previous(...a)),onDragenter:t[1]||(t[1]=a=>i.editEvents.drag&&s.dnd&&s.dnd.viewSelectorDragEnter(a,'previous',e.$data)),onDragleave:t[2]||(t[2]=a=>i.editEvents.drag&&s.dnd&&s.dnd.viewSelectorDragLeave(a,'previous',e.$data)),'aria-label':`Previous ${s.view.id}`},[f(e.$slots,'arrow-prev')],42,Tt),S('div',Ct,[O(oe,{name:i.options.transitions?`slide-fade--${s.transitionDirection}`:''},{default:g(()=>[(c(),P(Ke(s.broaderView?'button':'span'),{type:!!s.broaderView&&'button',key:`${s.view.id}${s.view.startDate.toString()}`,onClick:t[3]||(t[3]=a=>!!s.broaderView&&s.switchToBroaderView()),'aria-label':!!s.broaderView&&`Go to ${s.broaderView} view`},{default:g(()=>[f(e.$slots,'title')]),_:3},8,['type','aria-label']))]),_:3},8,['name'])]),i.options.todayButton?(c(),v('button',{key:0,class:L(['vuecal__today-btn',{'vuecal__today-btn--highlighted':e.highlightedControl==='today'}]),type:'button',onClick:t[4]||(t[4]=(...a)=>s.goToToday&&s.goToToday(...a)),onDragenter:t[5]||(t[5]=a=>i.editEvents.drag&&s.dnd&&s.dnd.viewSelectorDragEnter(a,'today',e.$data)),onDragleave:t[6]||(t[6]=a=>i.editEvents.drag&&s.dnd&&s.dnd.viewSelectorDragLeave(a,'today',e.$data)),'aria-label':'Today'},[f(e.$slots,'today-button')],34)):_('',!0),S('button',{class:L(['vuecal__arrow vuecal__arrow--next',{'vuecal__arrow--highlighted':e.highlightedControl==='next'}]),type:'button',onClick:t[7]||(t[7]=(...a)=>s.next&&s.next(...a)),onDragenter:t[8]||(t[8]=a=>i.editEvents.drag&&s.dnd&&s.dnd.viewSelectorDragEnter(a,'next',e.$data)),onDragleave:t[9]||(t[9]=a=>i.editEvents.drag&&s.dnd&&s.dnd.viewSelectorDragLeave(a,'next',e.$data)),'aria-label':`Next ${s.view.id}`},[f(e.$slots,'arrow-next')],42,Mt)])),i.viewProps.weekDaysInHeader?(c(),P(r,{key:2,'week-days':i.weekDays,'transition-direction':s.transitionDirection,'switch-to-narrower-view':i.switchToNarrowerView},me({_:2},[e.$slots['weekday-heading']?{name:'weekday-heading',fn:g(({heading:a,view:d})=>[f(e.$slots,'weekday-heading',{heading:a,view:d})]),key:'0'}:void 0,e.$slots['split-label']?{name:'split-label',fn:g(({split:a})=>[f(e.$slots,'split-label',{split:a,view:s.view})]),key:'1'}:void 0]),1032,['week-days','transition-direction','switch-to-narrower-view'])):_('',!0),O(oe,{name:`slide-fade--${s.transitionDirection}`},{default:g(()=>[s.showDaySplits?(c(),v('div',St,[(c(!0),v(H,null,R(i.daySplits,(a,d)=>(c(),v('div',{class:L(['day-split-header',a.class||!1]),key:d},[f(e.$slots,'split-label',{split:a,view:s.view.id},()=>[j(T(a.label),1)])],2))),128))])):_('',!0)]),_:3},8,['name'])]);}]]),Vt=['draggable'],At={inject:['vuecal','utils','modules','view','domEvents','editEvents'],props:{cellFormattedDate:{type:String,default:''},event:{type:Object,default:()=>({})},cellEvents:{type:Array,default:()=>[]},overlaps:{type:Array,default:()=>[]},eventPosition:{type:Number,default:0},overlapsStreak:{type:Number,default:0},allDay:{type:Boolean,default:!1}},data:()=>({touch:{dragThreshold:30,startX:0,startY:0,dragged:!1}}),methods:{onMouseDown(e,t=!1){if('ontouchstart'in window&&!t)return!1;const{clickHoldAnEvent:i,focusAnEvent:n,resizeAnEvent:l,dragAnEvent:s}=this.domEvents;if(n._eid===this.event._eid&&i._eid===this.event._eid)return!0;this.focusEvent(),i._eid=null,this.vuecal.editEvents.delete&&this.event.deletable&&(i.timeoutId=setTimeout(()=>{l._eid||s._eid||(i._eid=this.event._eid,this.event.deleting=!0);},i.timeout));},onMouseUp(e){this.domEvents.focusAnEvent._eid!==this.event._eid||this.touch.dragged||(this.domEvents.focusAnEvent.mousedUp=!0),this.touch.dragged=!1;},onMouseEnter(e){e.preventDefault(),this.vuecal.emitWithEvent('event-mouse-enter',this.event);},onMouseLeave(e){e.preventDefault(),this.vuecal.emitWithEvent('event-mouse-leave',this.event);},onTouchMove(e){if(typeof this.vuecal.onEventClick!='function')return;const{clientX:t,clientY:i}=e.touches[0],{startX:n,startY:l,dragThreshold:s}=this.touch;(Math.abs(t-n)>s||Math.abs(i-l)>s)&&(this.touch.dragged=!0);},onTouchStart(e){this.touch.startX=e.touches[0].clientX,this.touch.startY=e.touches[0].clientY,this.onMouseDown(e,!0);},onEnterKeypress(e){if(typeof this.vuecal.onEventClick=='function')return this.vuecal.onEventClick(this.event,e);},onDblClick(e){if(typeof this.vuecal.onEventDblclick=='function')return this.vuecal.onEventDblclick(this.event,e);},onDragStart(e){this.dnd&&this.dnd.eventDragStart(e,this.event);},onDragEnd(){this.dnd&&this.dnd.eventDragEnd(this.event);},onResizeHandleMouseDown(){this.focusEvent(),this.domEvents.dragAnEvent._eid=null,this.domEvents.resizeAnEvent=Object.assign(this.domEvents.resizeAnEvent,{_eid:this.event._eid,start:(this.segment||this.event).start,split:this.event.split||null,segment:!!this.segment&&this.utils.date.formatDateLite(this.segment.start),originalEnd:new Date((this.segment||this.event).end),originalEndTimeMinutes:this.event.endTimeMinutes}),this.event.resizing=!0;},deleteEvent(e=!1){if('ontouchstart'in window&&!e)return!1;this.utils.event.deleteAnEvent(this.event);},touchDeleteEvent(e){this.deleteEvent(!0);},cancelDeleteEvent(){this.event.deleting=!1;},focusEvent(){const{focusAnEvent:e}=this.domEvents,t=e._eid;if(t!==this.event._eid){if(t){const i=this.view.events.find(n=>n._eid===t);i&&(i.focused=!1);}this.vuecal.cancelDelete(),this.vuecal.emitWithEvent('event-focus',this.event),e._eid=this.event._eid,this.event.focused=!0;}}},computed:{eventDimensions(){const{startTimeMinutes:e,endTimeMinutes:t}=this.segment||this.event;let i=e-this.vuecal.timeFrom;const n=Math.max(Math.round(i*this.vuecal.timeCellHeight/this.vuecal.timeStep),0);i=Math.min(t,this.vuecal.timeTo)-this.vuecal.timeFrom;const l=Math.round(i*this.vuecal.timeCellHeight/this.vuecal.timeStep);return{top:n,height:Math.max(l-n,5)};},eventStyles(){if(this.event.allDay||!this.vuecal.time||!this.event.endTimeMinutes||this.view.id==='month'||this.allDay)return{};let e=100/Math.min(this.overlaps.length+1,this.overlapsStreak),t=100/(this.overlaps.length+1)*this.eventPosition;this.vuecal.minEventWidth&&e<this.vuecal.minEventWidth&&(e=this.vuecal.minEventWidth,t=(100-this.vuecal.minEventWidth)/this.overlaps.length*this.eventPosition);const{top:i,height:n}=this.eventDimensions;return{top:`${i}px`,height:`${n}px`,width:`${e}%`,left:this.event.left&&`${this.event.left}px`||`${t}%`};},eventClasses(){const{isFirstDay:e,isLastDay:t}=this.segment||{};return{[this.event.class]:!!this.event.class,'vuecal__event--focus':this.event.focused,'vuecal__event--resizing':this.event.resizing,'vuecal__event--background':this.event.background,'vuecal__event--deletable':this.event.deleting,'vuecal__event--all-day':this.event.allDay,'vuecal__event--dragging':!this.event.draggingStatic&&this.event.dragging,'vuecal__event--static':this.event.dragging&&this.event.draggingStatic,'vuecal__event--multiple-days':!!this.segment,'event-start':this.segment&&e&&!t,'event-middle':this.segment&&!e&&!t,'event-end':this.segment&&t&&!e};},segment(){return this.event.segments&&this.event.segments[this.cellFormattedDate]||null;},draggable(){const{draggable:e,background:t,daysCount:i}=this.event;return this.vuecal.editEvents.drag&&e&&!t&&i===1;},resizable(){const{editEvents:e,time:t}=this.vuecal;return e.resize&&this.event.resizable&&t&&!this.allDay&&(!this.segment||this.segment&&this.segment.isLastDay)&&this.view.id!=='month';},dnd(){return this.modules.dnd;}}},xt=['data-split','aria-label','onTouchstart','onMousedown','onDragover','onDrop'],$t={key:0,class:'cell-time-labels'},Ht=['innerHTML'],Wt={key:2,class:'vuecal__cell-events'},Lt=['title'],Ye=G({inject:['vuecal','utils','modules','view','domEvents'],components:{Event:G(At,[['render',function(e,t,i,n,l,s){return c(),v('div',{class:L(['vuecal__event',s.eventClasses]),style:B(s.eventStyles),tabindex:'0',onFocus:t[4]||(t[4]=(...r)=>s.focusEvent&&s.focusEvent(...r)),onKeypress:t[5]||(t[5]=ge(K((...r)=>s.onEnterKeypress&&s.onEnterKeypress(...r),['stop']),['enter'])),onMouseenter:t[6]||(t[6]=(...r)=>s.onMouseEnter&&s.onMouseEnter(...r)),onMouseleave:t[7]||(t[7]=(...r)=>s.onMouseLeave&&s.onMouseLeave(...r)),onTouchstart:t[8]||(t[8]=K((...r)=>s.onTouchStart&&s.onTouchStart(...r),['stop'])),onMousedown:t[9]||(t[9]=r=>s.onMouseDown(r)),onMouseup:t[10]||(t[10]=(...r)=>s.onMouseUp&&s.onMouseUp(...r)),onTouchend:t[11]||(t[11]=(...r)=>s.onMouseUp&&s.onMouseUp(...r)),onTouchmove:t[12]||(t[12]=(...r)=>s.onTouchMove&&s.onTouchMove(...r)),onDblclick:t[13]||(t[13]=(...r)=>s.onDblClick&&s.onDblClick(...r)),draggable:s.draggable,onDragstart:t[14]||(t[14]=r=>s.draggable&&s.onDragStart(r)),onDragend:t[15]||(t[15]=r=>s.draggable&&s.onDragEnd())},[s.vuecal.editEvents.delete&&i.event.deletable?(c(),v('div',{key:0,class:'vuecal__event-delete',onClick:t[0]||(t[0]=K((...r)=>s.deleteEvent&&s.deleteEvent(...r),['stop'])),onTouchstart:t[1]||(t[1]=K((...r)=>s.touchDeleteEvent&&s.touchDeleteEvent(...r),['stop']))},T(s.vuecal.texts.deleteEvent),33)):_('',!0),f(e.$slots,'event',{event:i.event,view:s.view.id}),s.resizable?(c(),v('div',{key:1,class:'vuecal__event-resize-handle',contenteditable:'false',onMousedown:t[2]||(t[2]=K((...r)=>s.onResizeHandleMouseDown&&s.onResizeHandleMouseDown(...r),['stop','prevent'])),onTouchstart:t[3]||(t[3]=K((...r)=>s.onResizeHandleMouseDown&&s.onResizeHandleMouseDown(...r),['stop','prevent']))},null,32)):_('',!0)],46,Vt);}]])},props:{options:{type:Object,default:()=>({})},editEvents:{type:Object,required:!0},data:{type:Object,required:!0},cellSplits:{type:Array,default:()=>[]},minTimestamp:{type:[Number,null],default:null},maxTimestamp:{type:[Number,null],default:null},cellWidth:{type:[Number,Boolean],default:!1},allDay:{type:Boolean,default:!1}},data:()=>({cellOverlaps:{},cellOverlapsStreak:1,timeAtCursor:null,highlighted:!1,highlightedSplit:null}),methods:{getSplitAtCursor({target:e}){let t=e.classList.contains('vuecal__cell-split')?e:this.vuecal.findAncestor(e,'vuecal__cell-split');return t&&(t=t.attributes['data-split'].value,parseInt(t).toString()===t.toString()&&(t=parseInt(t))),t||null;},splitClasses(e){return{'vuecal__cell-split':!0,'vuecal__cell-split--highlighted':this.highlightedSplit===e.id,[e.class]:!!e.class};},checkCellOverlappingEvents(){this.options.time&&this.eventsCount&&!this.splitsCount&&(this.eventsCount===1?(this.cellOverlaps=[],this.cellOverlapsStreak=1):[this.cellOverlaps,this.cellOverlapsStreak]=this.utils.event.checkCellOverlappingEvents(this.events,this.options));},isDOMElementAnEvent(e){return this.vuecal.isDOMElementAnEvent(e);},selectCell(e,t=!1){const i=this.splitsCount?this.getSplitAtCursor(e):null;this.utils.cell.selectCell(t,this.timeAtCursor,i),this.timeAtCursor=null;},onCellkeyPressEnter(e){this.isSelected||this.onCellFocus(e);const t=this.splitsCount?this.getSplitAtCursor(e):null;this.utils.cell.keyPressEnterCell(this.timeAtCursor,t),this.timeAtCursor=null;},onCellFocus(e){if(!this.isSelected&&!this.isDisabled){this.isSelected=this.data.startDate;const t=this.splitsCount?this.getSplitAtCursor(e):null,i=this.timeAtCursor||this.data.startDate;this.vuecal.$emit('cell-focus',t?{date:i,split:t}:i);}},onCellMouseDown(e,t=null,i=!1){if('ontouchstart'in window&&!i)return!1;this.isSelected||this.onCellFocus(e);const{clickHoldACell:n,focusAnEvent:l}=this.domEvents;this.domEvents.cancelClickEventCreation=!1,n.eventCreated=!1,this.timeAtCursor=new Date(this.data.startDate);const{minutes:s,cursorCoords:{y:r}}=this.vuecal.minutesAtCursor(e);this.timeAtCursor.setMinutes(s);const a=this.isDOMElementAnEvent(e.target);!a&&l._eid&&((this.view.events.find(d=>d._eid===l._eid)||{}).focused=!1),this.editEvents.create&&!a&&this.setUpEventCreation(e,r);},setUpEventCreation(e,t){if(this.options.dragToCreateEvent&&['week','day'].includes(this.view.id)){const{dragCreateAnEvent:i}=this.domEvents;if(i.startCursorY=t,i.split=this.splitsCount?this.getSplitAtCursor(e):null,i.start=this.timeAtCursor,this.options.snapToTime){let n=60*this.timeAtCursor.getHours()+this.timeAtCursor.getMinutes();const l=n+this.options.snapToTime/2;n=l-l%this.options.snapToTime,i.start.setHours(0,n,0,0);}}else this.options.cellClickHold&&['month','week','day'].includes(this.view.id)&&this.setUpCellHoldTimer(e);},setUpCellHoldTimer(e){const{clickHoldACell:t}=this.domEvents;t.cellId=`${this.vuecal._.uid}_${this.data.formattedDate}`,t.split=this.splitsCount?this.getSplitAtCursor(e):null,t.timeoutId=setTimeout(()=>{if(t.cellId&&!this.domEvents.cancelClickEventCreation){const{_eid:i}=this.utils.event.createAnEvent(this.timeAtCursor,null,t.split?{split:t.split}:{});t.eventCreated=i;}},t.timeout);},onCellTouchStart(e,t=null){this.onCellMouseDown(e,t,!0);},onCellClick(e){this.isDOMElementAnEvent(e.target)||this.selectCell(e);},onCellDblClick(e){const t=new Date(this.data.startDate);t.setMinutes(this.vuecal.minutesAtCursor(e).minutes);const i=this.splitsCount?this.getSplitAtCursor(e):null;this.vuecal.$emit('cell-dblclick',i?{date:t,split:i}:t),this.options.dblclickToNavigate&&this.vuecal.switchToNarrowerView();},onCellContextMenu(e){e.stopPropagation(),e.preventDefault();const t=new Date(this.data.startDate),{cursorCoords:i,minutes:n}=this.vuecal.minutesAtCursor(e);t.setMinutes(n);const l=this.splitsCount?this.getSplitAtCursor(e):null;this.vuecal.$emit('cell-contextmenu',{date:t,...i,...l||{},e});}},computed:{dnd(){return this.modules.dnd;},nowInMinutes(){return this.utils.date.dateToMinutes(this.vuecal.now);},isBeforeMinDate(){return this.minTimestamp!==null&&this.minTimestamp>this.data.endDate.getTime();},isAfterMaxDate(){return this.maxTimestamp&&this.maxTimestamp<this.data.startDate.getTime();},isDisabled(){const{disableDays:e}=this.options,{isYearsOrYearView:t}=this.vuecal;return!(!e.length||!e.includes(this.data.formattedDate)||t)||this.isBeforeMinDate||this.isAfterMaxDate;},isSelected:{get(){let e=!1;const{selectedDate:t}=this.view;return e=this.view.id==='years'?t.getFullYear()===this.data.startDate.getFullYear():this.view.id==='year'?t.getFullYear()===this.data.startDate.getFullYear()&&t.getMonth()===this.data.startDate.getMonth():t.getTime()===this.data.startDate.getTime(),e;},set(e){this.view.selectedDate=e,this.vuecal.$emit('update:selected-date',this.view.selectedDate);}},isWeekOrDayView(){return['week','day'].includes(this.view.id);},transitionDirection(){return this.vuecal.transitionDirection;},specialHours(){return this.data.specialHours.map(e=>{let{from:t,to:i}=e;return t=Math.max(t,this.options.timeFrom),i=Math.min(i,this.options.timeTo),{...e,height:(i-t)*this.timeScale,top:(t-this.options.timeFrom)*this.timeScale};});},events(){const{startDate:e,endDate:t}=this.data;let i=[];if(!['years','year'].includes(this.view.id)||this.options.eventsCountOnYearView){if(i=this.view.events.slice(0),this.view.id==='month'&&i.push(...this.view.outOfScopeEvents),i=i.filter(n=>this.utils.event.eventInRange(n,e,t)),this.options.showAllDayEvents&&this.view.id!=='month'&&(i=i.filter(n=>!!n.allDay===this.allDay)),this.options.time&&this.isWeekOrDayView&&!this.allDay){const{timeFrom:n,timeTo:l}=this.options;i=i.filter(s=>{const r=s.daysCount>1&&s.segments[this.data.formattedDate]||{},a=s.daysCount===1&&s.startTimeMinutes<l&&s.endTimeMinutes>n,d=s.daysCount>1&&r.startTimeMinutes<l&&r.endTimeMinutes>n;return s.allDay||a||d||!1;});}!this.options.time||!this.isWeekOrDayView||this.options.showAllDayEvents&&this.allDay||i.sort((n,l)=>n.start<l.start?-1:1),this.cellSplits.length||this.$nextTick(this.checkCellOverlappingEvents);}return i;},eventsCount(){return this.events.length;},splits(){return this.cellSplits.map((e,t)=>{const i=this.events.filter(s=>s.split===e.id),[n,l]=this.utils.event.checkCellOverlappingEvents(i.filter(s=>!s.background&&!s.allDay),this.options);return{...e,overlaps:n,overlapsStreak:l,events:i};});},splitsCount(){return this.splits.length;},cellClasses(){return{[this.data.class]:!!this.data.class,'vuecal__cell--current':this.data.current,'vuecal__cell--today':this.data.today,'vuecal__cell--out-of-scope':this.data.outOfScope,'vuecal__cell--before-min':this.isDisabled&&this.isBeforeMinDate,'vuecal__cell--after-max':this.isDisabled&&this.isAfterMaxDate,'vuecal__cell--disabled':this.isDisabled,'vuecal__cell--selected':this.isSelected,'vuecal__cell--highlighted':this.highlighted,'vuecal__cell--has-splits':this.splitsCount,'vuecal__cell--has-events':this.eventsCount};},cellStyles(){return{...this.cellWidth?{width:`${this.cellWidth}%`}:{}};},timelineVisible(){const{time:e,timeTo:t}=this.options;return this.data.today&&this.isWeekOrDayView&&e&&!this.allDay&&this.nowInMinutes<=t;},todaysTimePosition(){if(!this.data.today||!this.options.time)return;const e=this.nowInMinutes-this.options.timeFrom;return Math.round(e*this.timeScale);},timeScale(){return this.options.timeCellHeight/this.options.timeStep;}}},[['render',function(e,t,i,n,l,s){const r=q('event');return c(),P(Xe,{class:L(['vuecal__cell',s.cellClasses]),name:`slide-fade--${s.transitionDirection}`,tag:'div',appear:i.options.transitions,style:B(s.cellStyles)},{default:g(()=>[(c(!0),v(H,null,R(s.splitsCount?s.splits:1,(a,d)=>(c(),v('div',{class:L(['vuecal__flex vuecal__cell-content',s.splitsCount&&s.splitClasses(a)]),key:i.options.transitions?`${s.view.id}-${i.data.content}-${d}`:d,'data-split':!!s.splitsCount&&a.id,column:'',tabindex:'0','aria-label':i.data.content,onFocus:t[0]||(t[0]=o=>s.onCellFocus(o)),onKeypress:t[1]||(t[1]=ge(o=>s.onCellkeyPressEnter(o),['enter'])),onTouchstart:o=>!s.isDisabled&&s.onCellTouchStart(o,s.splitsCount?a.id:null),onMousedown:o=>!s.isDisabled&&s.onCellMouseDown(o,s.splitsCount?a.id:null),onClick:t[2]||(t[2]=o=>!s.isDisabled&&s.onCellClick(o)),onDblclick:t[3]||(t[3]=o=>!s.isDisabled&&s.onCellDblClick(o)),onContextmenu:t[4]||(t[4]=o=>!s.isDisabled&&i.options.cellContextmenu&&s.onCellContextMenu(o)),onDragenter:t[5]||(t[5]=o=>!s.isDisabled&&i.editEvents.drag&&s.dnd&&s.dnd.cellDragEnter(o,e.$data,i.data.startDate)),onDragover:o=>!s.isDisabled&&i.editEvents.drag&&s.dnd&&s.dnd.cellDragOver(o,e.$data,i.data.startDate,s.splitsCount?a.id:null),onDragleave:t[6]||(t[6]=o=>!s.isDisabled&&i.editEvents.drag&&s.dnd&&s.dnd.cellDragLeave(o,e.$data,i.data.startDate)),onDrop:o=>!s.isDisabled&&i.editEvents.drag&&s.dnd&&s.dnd.cellDragDrop(o,e.$data,i.data.startDate,s.splitsCount?a.id:null)},[i.options.showTimeInCells&&i.options.time&&s.isWeekOrDayView&&!i.allDay?(c(),v('div',$t,[(c(!0),v(H,null,R(s.vuecal.timeCells,(o,u)=>(c(),v('span',{class:'cell-time-label',key:u},T(o.label),1))),128))])):_('',!0),s.isWeekOrDayView&&!i.allDay&&s.specialHours.length?(c(!0),v(H,{key:1},R(s.specialHours,(o,u)=>(c(),v('div',{class:L(['vuecal__special-hours',`vuecal__special-hours--day${o.day} ${o.class}`]),style:B(`height: ${o.height}px;top: ${o.top}px`)},[o.label?(c(),v('div',{key:0,class:'special-hours-label',innerHTML:o.label},null,8,Ht)):_('',!0)],6))),256)):_('',!0),f(e.$slots,'cell-content',{events:s.events,selectCell:o=>s.selectCell(o,!0),split:!!s.splitsCount&&a}),s.eventsCount&&(s.isWeekOrDayView||s.view.id==='month'&&i.options.eventsOnMonthView)?(c(),v('div',Wt,[(c(!0),v(H,null,R(s.splitsCount?a.events:s.events,(o,u)=>(c(),P(r,{key:u,'cell-formatted-date':i.data.formattedDate,event:o,'all-day':i.allDay,'cell-events':s.splitsCount?a.events:s.events,overlaps:((s.splitsCount?a.overlaps[o._eid]:e.cellOverlaps[o._eid])||[]).overlaps,'event-position':((s.splitsCount?a.overlaps[o._eid]:e.cellOverlaps[o._eid])||[]).position,'overlaps-streak':s.splitsCount?a.overlapsStreak:e.cellOverlapsStreak},{event:g(({event:y,view:D})=>[f(e.$slots,'event',{view:D,event:y})]),_:2},1032,['cell-formatted-date','event','all-day','cell-events','overlaps','event-position','overlaps-streak']))),128))])):_('',!0)],42,xt))),128)),s.timelineVisible?(c(),v('div',{class:'vuecal__now-line',style:B(`top: ${s.todaysTimePosition}px`),key:i.options.transitions?`${s.view.id}-now-line`:'now-line',title:s.utils.date.formatTime(s.vuecal.now)},null,12,Lt)):_('',!0)]),_:3},8,['class','name','appear','style']);}]]),It={key:0,class:'vuecal__all-day-text',style:{width:'3em'}},jt=G({inject:['vuecal','view','editEvents'],components:{'vuecal-cell':Ye},props:{options:{type:Object,required:!0},cells:{type:Array,required:!0},label:{type:String,required:!0},daySplits:{type:Array,default:()=>[]},shortEvents:{type:Boolean,default:!0},height:{type:String,default:''},cellOrSplitMinWidth:{type:Number,default:null}},computed:{hasCellOrSplitWidth(){return!!(this.options.minCellWidth||this.daySplits.length&&this.options.minSplitWidth);}}},[['render',function(e,t,i,n,l,s){const r=q('vuecal-cell');return c(),v('div',{class:'vuecal__flex vuecal__all-day',style:B(i.cellOrSplitMinWidth&&{height:i.height})},[i.cellOrSplitMinWidth?_('',!0):(c(),v('div',It,[S('span',null,T(i.label),1)])),S('div',{class:L(['vuecal__flex vuecal__cells',`${s.view.id}-view`]),grow:'',style:B(i.cellOrSplitMinWidth?`min-width: ${i.cellOrSplitMinWidth}px`:'')},[(c(!0),v(H,null,R(i.cells,(a,d)=>(c(),P(r,{key:d,options:i.options,'edit-events':s.editEvents,data:a,'all-day':!0,'cell-width':i.options.hideWeekdays.length&&(s.vuecal.isWeekView||s.vuecal.isMonthView)&&s.vuecal.cellWidth,'min-timestamp':i.options.minTimestamp,'max-timestamp':i.options.maxTimestamp,'cell-splits':i.daySplits},{event:g(({event:o,view:u})=>[f(e.$slots,'event',{view:u,event:o})]),_:2},1032,['options','edit-events','data','cell-width','min-timestamp','max-timestamp','cell-splits']))),128))],6)],4);}]]),Yt=['lang'],Ft=S('i',{class:'angle'},null,-1),Pt=S('i',{class:'angle'},null,-1),Rt={class:'default'},Nt={key:0,class:'vuecal__flex vuecal__body',grow:''},Bt=['onBlur','innerHTML'],zt=['innerHTML'],Ut=['innerHTML'],qt={class:'vuecal__flex',row:'',grow:''},Kt={key:0,class:'vuecal__time-column'},Xt=S('span',{class:'vuecal__time-cell-line'},null,-1),Gt={class:'vuecal__time-cell-label'},Zt={key:1,class:'vuecal__flex vuecal__week-numbers',column:''},Jt=['wrap','column'],Qt=['onBlur','innerHTML'],ei=['innerHTML'],ti=['innerHTML'],ii=['wrap'],si=['innerHTML'],ni=['innerHTML'],ai={key:2,class:'vuecal__cell-events-count'},li={key:3,class:'vuecal__no-event'},ri=['onBlur','innerHTML'],oi=['innerHTML'],di={key:2,class:'vuecal__event-time'},ui={key:0},ci={key:1,class:'days-to-end'},vi=['innerHTML'],hi={key:0,class:'vuecal__scrollbar-check'},mi=[S('div',null,null,-1)],ne={weekDays:Array(7).fill(''),weekDaysShort:[],months:Array(12).fill(''),years:'',year:'',month:'',week:'',day:'',today:'',noEvent:'',allDay:'',deleteEvent:'',createEvent:'',dateFormat:'dddd MMMM D, YYYY',am:'am',pm:'pm'},Ve=['years','year','month','week','day'],Ae=new class{constructor(e,t=!1){U(this,'texts',{}),U(this,'dateToMinutes',i=>60*i.getHours()+i.getMinutes()),N=this,this._texts=e,t||!Date||Date.prototype.addDays||this._initDatePrototypes();}_initDatePrototypes(){Date.prototype.addDays=function(e){return N.addDays(this,e);},Date.prototype.subtractDays=function(e){return N.subtractDays(this,e);},Date.prototype.addHours=function(e){return N.addHours(this,e);},Date.prototype.subtractHours=function(e){return N.subtractHours(this,e);},Date.prototype.addMinutes=function(e){return N.addMinutes(this,e);},Date.prototype.subtractMinutes=function(e){return N.subtractMinutes(this,e);},Date.prototype.getWeek=function(){return N.getWeek(this);},Date.prototype.isToday=function(){return N.isToday(this);},Date.prototype.isLeapYear=function(){return N.isLeapYear(this);},Date.prototype.format=function(e='YYYY-MM-DD'){return N.formatDate(this,e);},Date.prototype.formatTime=function(e='HH:mm'){return N.formatTime(this,e);};}removePrototypes(){delete Date.prototype.addDays,delete Date.prototype.subtractDays,delete Date.prototype.addHours,delete Date.prototype.subtractHours,delete Date.prototype.addMinutes,delete Date.prototype.subtractMinutes,delete Date.prototype.getWeek,delete Date.prototype.isToday,delete Date.prototype.isLeapYear,delete Date.prototype.format,delete Date.prototype.formatTime;}updateTexts(e){this._texts=e;}_todayFormatted(){return Se!==new Date().getDate()&&(ie=new Date,Se=ie.getDate(),Oe=`${ie.getFullYear()}-${ie.getMonth()}-${ie.getDate()}`),Oe;}addDays(e,t){const i=new Date(e.valueOf());return i.setDate(i.getDate()+t),i;}subtractDays(e,t){const i=new Date(e.valueOf());return i.setDate(i.getDate()-t),i;}addHours(e,t){const i=new Date(e.valueOf());return i.setHours(i.getHours()+t),i;}subtractHours(e,t){const i=new Date(e.valueOf());return i.setHours(i.getHours()-t),i;}addMinutes(e,t){const i=new Date(e.valueOf());return i.setMinutes(i.getMinutes()+t),i;}subtractMinutes(e,t){const i=new Date(e.valueOf());return i.setMinutes(i.getMinutes()-t),i;}getWeek(e){const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),i=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-i);const n=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t-n)/864e5+1)/7);}isToday(e){return`${e.getFullYear()}-${e.getMonth()}-${e.getDate()}`===this._todayFormatted();}isLeapYear(e){const t=e.getFullYear();return!(t%400)||t%100&&!(t%4);}getPreviousFirstDayOfWeek(e=null,t){const i=e&&new Date(e.valueOf())||new Date,n=t?7:6;return i.setDate(i.getDate()-(i.getDay()+n)%7),i;}stringToDate(e){return e instanceof Date?e:(e.length===10&&(e+=' 00:00'),new Date(e.replace(/-/g,'/')));}countDays(e,t){typeof e=='string'&&(e=e.replace(/-/g,'/')),typeof t=='string'&&(t=t.replace(/-/g,'/')),e=new Date(e).setHours(0,0,0,0),t=new Date(t).setHours(0,0,1,0);const i=60*(new Date(t).getTimezoneOffset()-new Date(e).getTimezoneOffset())*1e3;return Math.ceil((t-e-i)/864e5);}datesInSameTimeStep(e,t,i){return Math.abs(e.getTime()-t.getTime())<=60*i*1e3;}formatDate(e,t='YYYY-MM-DD',i=null){if(i||(i=this._texts),t||(t='YYYY-MM-DD'),t==='YYYY-MM-DD')return this.formatDateLite(e);se={},X={};const n={YYYY:()=>this._hydrateDateObject(e,i).YYYY,YY:()=>this._hydrateDateObject(e,i).YY(),M:()=>this._hydrateDateObject(e,i).M,MM:()=>this._hydrateDateObject(e,i).MM(),MMM:()=>this._hydrateDateObject(e,i).MMM(),MMMM:()=>this._hydrateDateObject(e,i).MMMM(),MMMMG:()=>this._hydrateDateObject(e,i).MMMMG(),D:()=>this._hydrateDateObject(e,i).D,DD:()=>this._hydrateDateObject(e,i).DD(),S:()=>this._hydrateDateObject(e,i).S(),d:()=>this._hydrateDateObject(e,i).d,dd:()=>this._hydrateDateObject(e,i).dd(),ddd:()=>this._hydrateDateObject(e,i).ddd(),dddd:()=>this._hydrateDateObject(e,i).dddd(),HH:()=>this._hydrateTimeObject(e,i).HH,H:()=>this._hydrateTimeObject(e,i).H,hh:()=>this._hydrateTimeObject(e,i).hh,h:()=>this._hydrateTimeObject(e,i).h,am:()=>this._hydrateTimeObject(e,i).am,AM:()=>this._hydrateTimeObject(e,i).AM,mm:()=>this._hydrateTimeObject(e,i).mm,m:()=>this._hydrateTimeObject(e,i).m};return t.replace(/(\{[a-zA-Z]+\}|[a-zA-Z]+)/g,(l,s)=>{const r=n[s.replace(/\{|\}/g,'')];return r!==void 0?r():s;});}formatDateLite(e){const t=e.getMonth()+1,i=e.getDate();return`${e.getFullYear()}-${t<10?'0':''}${t}-${i<10?'0':''}${i}`;}formatTime(e,t='HH:mm',i=null,n=!1){let l=!1;if(n){const[a,d,o]=[e.getHours(),e.getMinutes(),e.getSeconds()];a+d+o===141&&(l=!0);}if(e instanceof Date&&t==='HH:mm')return l?'24:00':this.formatTimeLite(e);X={},i||(i=this._texts);const s=this._hydrateTimeObject(e,i),r=t.replace(/(\{[a-zA-Z]+\}|[a-zA-Z]+)/g,(a,d)=>{const o=s[d.replace(/\{|\}/g,'')];return o!==void 0?o:d;});return l?r.replace('23:59','24:00'):r;}formatTimeLite(e){const t=e.getHours(),i=e.getMinutes();return`${(t<10?'0':'')+t}:${(i<10?'0':'')+i}`;}_nth(e){if(e>3&&e<21)return'th';switch(e%10){case 1:return'st';case 2:return'nd';case 3:return'rd';default:return'th';}}_hydrateDateObject(e,t){if(se.D)return se;const i=e.getFullYear(),n=e.getMonth()+1,l=e.getDate(),s=(e.getDay()-1+7)%7;return se={YYYY:i,YY:()=>i.toString().substring(2),M:n,MM:()=>(n<10?'0':'')+n,MMM:()=>t.months[n-1].substring(0,3),MMMM:()=>t.months[n-1],MMMMG:()=>(t.monthsGenitive||t.months)[n-1],D:l,DD:()=>(l<10?'0':'')+l,S:()=>this._nth(l),d:s+1,dd:()=>t.weekDays[s][0],ddd:()=>t.weekDays[s].substr(0,3),dddd:()=>t.weekDays[s]},se;}_hydrateTimeObject(e,t){if(X.am)return X;let i,n;e instanceof Date?(i=e.getHours(),n=e.getMinutes()):(i=Math.floor(e/60),n=Math.floor(e%60));const l=i%12?i%12:12,s=(t||{am:'am',pm:'pm'})[i===24||i<12?'am':'pm'];return X={H:i,h:l,HH:(i<10?'0':'')+i,hh:(l<10?'0':'')+l,am:s,AM:s.toUpperCase(),m:n,mm:(n<10?'0':'')+n},X;}}(ne),pi={name:'vue-cal',components:{'vuecal-cell':Ye,'vuecal-header':Ot,WeekdaysHeadings:je,AllDayBar:jt},provide(){return{vuecal:this,utils:this.utils,modules:this.modules,previous:this.previous,next:this.next,switchView:this.switchView,updateSelectedDate:this.updateSelectedDate,editEvents:this.editEvents,view:this.view,domEvents:this.domEvents};},props:{activeView:{type:String,default:'week'},allDayBarHeight:{type:[String,Number],default:'25px'},cellClickHold:{type:Boolean,default:!0},cellContextmenu:{type:Boolean,default:!1},clickToNavigate:{type:Boolean,default:!1},dblclickToNavigate:{type:Boolean,default:!0},disableDatePrototypes:{type:Boolean,default:!1},disableDays:{type:Array,default:()=>[]},disableViews:{type:Array,default:()=>[]},dragToCreateEvent:{type:Boolean,default:!0},dragToCreateThreshold:{type:Number,default:15},editableEvents:{type:[Boolean,Object],default:!1},events:{type:Array,default:()=>[]},eventsCountOnYearView:{type:Boolean,default:!1},eventsOnMonthView:{type:[Boolean,String],default:!1},hideBody:{type:Boolean,default:!1},hideTitleBar:{type:Boolean,default:!1},hideViewSelector:{type:Boolean,default:!1},hideWeekdays:{type:Array,default:()=>[]},hideWeekends:{type:Boolean,default:!1},locale:{type:[String,Object],default:'en'},maxDate:{type:[String,Date],default:''},minCellWidth:{type:Number,default:0},minDate:{type:[String,Date],default:''},minEventWidth:{type:Number,default:0},minSplitWidth:{type:Number,default:0},onEventClick:{type:[Function,null],default:null},onEventCreate:{type:[Function,null],default:null},onEventDblclick:{type:[Function,null],default:null},overlapsPerTimeStep:{type:Boolean,default:!1},resizeX:{type:Boolean,default:!1},selectedDate:{type:[String,Date],default:''},showAllDayEvents:{type:[Boolean,String],default:!1},showTimeInCells:{type:Boolean,default:!1},showWeekNumbers:{type:[Boolean,String],default:!1},snapToTime:{type:Number,default:0},small:{type:Boolean,default:!1},specialHours:{type:Object,default:()=>({})},splitDays:{type:Array,default:()=>[]},startWeekOnSunday:{type:Boolean,default:!1},stickySplitLabels:{type:Boolean,default:!1},time:{type:Boolean,default:!0},timeCellHeight:{type:Number,default:40},timeFormat:{type:String,default:''},timeFrom:{type:Number,default:0},timeStep:{type:Number,default:60},timeTo:{type:Number,default:1440},todayButton:{type:Boolean,default:!1},transitions:{type:Boolean,default:!0},twelveHour:{type:Boolean,default:!1},watchRealTime:{type:Boolean,default:!1},xsmall:{type:Boolean,default:!1}},data(){return{ready:!1,texts:{...ne},utils:{date:!!this.disableDatePrototypes&&Ae.removePrototypes()||Ae,cell:null,event:null},modules:{dnd:null},cellsEl:null,view:{id:'',title:'',startDate:null,endDate:null,firstCellDate:null,lastCellDate:null,selectedDate:null,events:[]},eventIdIncrement:1,now:new Date,timeTickerIds:[null,null],domEvents:{resizeAnEvent:{_eid:null,start:null,split:null,segment:null,originalEndTimeMinutes:0,originalEnd:null,end:null,startCell:null,endCell:null},dragAnEvent:{_eid:null},dragCreateAnEvent:{startCursorY:null,start:null,split:null,event:null},focusAnEvent:{_eid:null,mousedUp:!1},clickHoldAnEvent:{_eid:null,timeout:1200,timeoutId:null},dblTapACell:{taps:0,timeout:500},clickHoldACell:{cellId:null,split:null,timeout:1200,timeoutId:null,eventCreated:!1},cancelClickEventCreation:!1},mutableEvents:[],transitionDirection:'right'};},methods:{async loadLocale(e){if(typeof this.locale=='object')return this.texts=Object.assign({},ne,e),void this.utils.date.updateTexts(this.texts);if(this.locale==='en'){const t=await w(()=>import('./en.es-713916b0.js'),[]);this.texts=Object.assign({},ne,t);}else((t,i)=>{const n=t[i];return n?typeof n=='function'?n():Promise.resolve(n):new Promise((l,s)=>{(typeof queueMicrotask=='function'?queueMicrotask:setTimeout)(s.bind(null,new Error('Unknown variable dynamic import: '+i)));});})(Object.assign({'./i18n/ar.json':()=>w(()=>import('./ar.es-4173cb29.js'),[]),'./i18n/bg.json':()=>w(()=>import('./bg.es-3542f853.js'),[]),'./i18n/bn.json':()=>w(()=>import('./bn.es-55ab5212.js'),[]),'./i18n/bs.json':()=>w(()=>import('./bs.es-ba9dd541.js'),[]),'./i18n/ca.json':()=>w(()=>import('./ca.es-3f4af411.js'),[]),'./i18n/cs.json':()=>w(()=>import('./cs.es-4bf8e61a.js'),[]),'./i18n/da.json':()=>w(()=>import('./da.es-084484fb.js'),[]),'./i18n/de.json':()=>w(()=>import('./de.es-0185602c.js'),[]),'./i18n/el.json':()=>w(()=>import('./el.es-b3db55e7.js'),[]),'./i18n/en.json':()=>w(()=>import('./en.es-713916b0.js'),[]),'./i18n/es.json':()=>w(()=>import('./es.es-2f81ef8f.js'),[]),'./i18n/et.json':()=>w(()=>import('./et.es-feab242e.js'),[]),'./i18n/fa.json':()=>w(()=>import('./fa.es-e30ec481.js'),[]),'./i18n/fr.json':()=>w(()=>import('./fr.es-fd781cdb.js'),[]),'./i18n/he.json':()=>w(()=>import('./he.es-ab017da7.js'),[]),'./i18n/hr.json':()=>w(()=>import('./hr.es-8ff4208c.js'),[]),'./i18n/hu.json':()=>w(()=>import('./hu.es-a826dbea.js'),[]),'./i18n/id.json':()=>w(()=>import('./id.es-09894c24.js'),[]),'./i18n/is.json':()=>w(()=>import('./is.es-9608cdad.js'),[]),'./i18n/it.json':()=>w(()=>import('./it.es-8f484e02.js'),[]),'./i18n/ja.json':()=>w(()=>import('./ja.es-b7fc0eb9.js'),[]),'./i18n/ka.json':()=>w(()=>import('./ka.es-446e6e19.js'),[]),'./i18n/ko.json':()=>w(()=>import('./ko.es-45e7d699.js'),[]),'./i18n/lt.json':()=>w(()=>import('./lt.es-bc184482.js'),[]),'./i18n/mn.json':()=>w(()=>import('./mn.es-5fa17a96.js'),[]),'./i18n/nl.json':()=>w(()=>import('./nl.es-f5998f61.js'),[]),'./i18n/no.json':()=>w(()=>import('./no.es-7a7b8685.js'),[]),'./i18n/pl.json':()=>w(()=>import('./pl.es-2dc4cbea.js'),[]),'./i18n/pt-br.json':()=>w(()=>import('./pt-br.es-82c2bfad.js'),[]),'./i18n/ro.json':()=>w(()=>import('./ro.es-0b230c59.js'),[]),'./i18n/ru.json':()=>w(()=>import('./ru.es-3bc3c295.js'),[]),'./i18n/sk.json':()=>w(()=>import('./sk.es-477d958c.js'),[]),'./i18n/sl.json':()=>w(()=>import('./sl.es-7f9e39ca.js'),[]),'./i18n/sq.json':()=>w(()=>import('./sq.es-484abfbf.js'),[]),'./i18n/sr.json':()=>w(()=>import('./sr.es-79173882.js'),[]),'./i18n/sv.json':()=>w(()=>import('./sv.es-cc28424b.js'),[]),'./i18n/tr.json':()=>w(()=>import('./tr.es-73d31d0a.js'),[]),'./i18n/uk.json':()=>w(()=>import('./uk.es-72aa5132.js'),[]),'./i18n/vi.json':()=>w(()=>import('./vi.es-e48f04c7.js'),[]),'./i18n/zh-cn.json':()=>w(()=>import('./zh-cn.es-d3b0ce92.js'),[]),'./i18n/zh-hk.json':()=>w(()=>import('./zh-hk.es-f0804a56.js'),[])}),`./i18n/${e}.json`).then(t=>{this.texts=Object.assign({},ne,t.default),this.utils.date.updateTexts(this.texts);});},loadDragAndDrop(){w(()=>import('./drag-and-drop.es-801b9187.js'),[]).then(e=>{const{DragAndDrop:t}=e;this.modules.dnd=new t(this);}).catch(()=>console.warn('Vue Cal: Missing drag & drop module.'));},validateView(e){return Ve.includes(e)||(console.error(`Vue Cal: invalid active-view parameter provided: "${e}".
A valid view must be one of: ${Ve.join(', ')}.`),e='week'),this.enabledViews.includes(e)||(console.warn(`Vue Cal: the provided active-view "${e}" is disabled. Using the "${this.enabledViews[0]}" view instead.`),e=this.enabledViews[0]),e;},switchToNarrowerView(e=null){this.transitionDirection='right';const t=this.enabledViews[this.enabledViews.indexOf(this.view.id)+1];t&&this.switchView(t,e);},switchView(e,t=null,i=!1){e=this.validateView(e);const n=this.utils.date,l=this.view.startDate&&this.view.startDate.getTime();if(this.transitions&&i){if(this.view.id===e)return;const a=this.enabledViews;this.transitionDirection=a.indexOf(this.view.id)>a.indexOf(e)?'left':'right';}const s=this.view.id;switch(this.view.events=[],this.view.id=e,this.view.firstCellDate=null,this.view.lastCellDate=null,t||(t=this.view.selectedDate||this.view.startDate),e){case'years':this.view.startDate=new Date(25*Math.floor(t.getFullYear()/25)||2e3,0,1),this.view.endDate=new Date(this.view.startDate.getFullYear()+25,0,1),this.view.endDate.setSeconds(-1);break;case'year':this.view.startDate=new Date(t.getFullYear(),0,1),this.view.endDate=new Date(t.getFullYear()+1,0,1),this.view.endDate.setSeconds(-1);break;case'month':{this.view.startDate=new Date(t.getFullYear(),t.getMonth(),1),this.view.endDate=new Date(t.getFullYear(),t.getMonth()+1,1),this.view.endDate.setSeconds(-1);let a=new Date(this.view.startDate);if(a.getDay()!==(this.startWeekOnSunday?0:1)&&(a=n.getPreviousFirstDayOfWeek(a,this.startWeekOnSunday)),this.view.firstCellDate=a,this.view.lastCellDate=n.addDays(a,41),this.view.lastCellDate.setHours(23,59,59,0),this.hideWeekends){if([0,6].includes(this.view.firstCellDate.getDay())){const d=this.view.firstCellDate.getDay()!==6||this.startWeekOnSunday?1:2;this.view.firstCellDate=n.addDays(this.view.firstCellDate,d);}if([0,6].includes(this.view.startDate.getDay())){const d=this.view.startDate.getDay()===6?2:1;this.view.startDate=n.addDays(this.view.startDate,d);}if([0,6].includes(this.view.lastCellDate.getDay())){const d=this.view.lastCellDate.getDay()!==0||this.startWeekOnSunday?1:2;this.view.lastCellDate=n.subtractDays(this.view.lastCellDate,d);}if([0,6].includes(this.view.endDate.getDay())){const d=this.view.endDate.getDay()===0?2:1;this.view.endDate=n.subtractDays(this.view.endDate,d);}}break;}case'week':{t=n.getPreviousFirstDayOfWeek(t,this.startWeekOnSunday);const a=this.hideWeekends?5:7;this.view.startDate=this.hideWeekends&&this.startWeekOnSunday?n.addDays(t,1):t,this.view.startDate.setHours(0,0,0,0),this.view.endDate=n.addDays(t,a),this.view.endDate.setSeconds(-1);break;}case'day':this.view.startDate=t,this.view.startDate.setHours(0,0,0,0),this.view.endDate=new Date(t),this.view.endDate.setHours(23,59,59,0);}this.addEventsToView();const r=this.view.startDate&&this.view.startDate.getTime();if((s!==e||r!==l)&&(this.$emit('update:activeView',e),this.ready)){const a=this.view.startDate,d={view:e,startDate:a,endDate:this.view.endDate,...this.isMonthView?{firstCellDate:this.view.firstCellDate,lastCellDate:this.view.lastCellDate,outOfScopeEvents:this.view.outOfScopeEvents.map(this.cleanupEvent)}:{},events:this.view.events.map(this.cleanupEvent),...this.isWeekView?{week:n.getWeek(this.startWeekOnSunday?n.addDays(a,1):a)}:{}};this.$emit('view-change',d);}},previous(){this.previousNext(!1);},next(){this.previousNext();},previousNext(e=!0){const t=this.utils.date;this.transitionDirection=e?'right':'left';const i=e?1:-1;let n=null;const{startDate:l,id:s}=this.view;switch(s){case'years':n=new Date(l.getFullYear()+25*i,0,1);break;case'year':n=new Date(l.getFullYear()+1*i,1,1);break;case'month':n=new Date(l.getFullYear(),l.getMonth()+1*i,1);break;case'week':n=t[e?'addDays':'subtractDays'](t.getPreviousFirstDayOfWeek(l,this.startWeekOnSunday),7);break;case'day':n=t[e?'addDays':'subtractDays'](l,1);const r=n.getDay(),a=this.startWeekOnSunday?r:(r||7)-1;if(this.weekDays[a].hide){const d=this.weekDays.map((u,y)=>({...u,i:y}));let o=0;e?([...d.slice(a),...d].find(u=>(o++,!u.hide)).i,o--):[...d,...d.slice(0,a)].reverse().find(u=>(o++,!u.hide)).i,n=t[e?'addDays':'subtractDays'](n,o);}}n&&this.switchView(s,n);},addEventsToView(e=[]){const t=this.utils.event,{startDate:i,endDate:n,firstCellDate:l,lastCellDate:s}=this.view;if(e.length||(this.view.events=[]),!(e=e.length?e:[...this.mutableEvents])||this.isYearsOrYearView&&!this.eventsCountOnYearView)return;let r=e.filter(a=>t.eventInRange(a,i,n));this.isYearsOrYearView||this.isMonthView&&!this.eventsOnMonthView||(r=r.map(a=>a.daysCount>1?t.createEventSegments(a,l||i,s||n):a)),this.view.events.push(...r),this.isMonthView&&(this.view.outOfScopeEvents=[],e.forEach(a=>{(t.eventInRange(a,l,i)||t.eventInRange(a,n,s))&&(this.view.events.some(d=>d._eid===a._eid)||this.view.outOfScopeEvents.push(a));}));},findAncestor(e,t){for(;(e=e.parentElement)&&!e.classList.contains(t););return e;},isDOMElementAnEvent(e){return e.classList.contains('vuecal__event')||this.findAncestor(e,'vuecal__event');},onMouseMove(e){const{resizeAnEvent:t,dragAnEvent:i,dragCreateAnEvent:n}=this.domEvents;(t._eid!==null||i._eid!==null||n.start)&&(e.preventDefault(),t._eid?this.eventResizing(e):this.dragToCreateEvent&&n.start&&this.eventDragCreation(e));},onMouseUp(e){const{focusAnEvent:t,resizeAnEvent:i,clickHoldAnEvent:n,clickHoldACell:l,dragCreateAnEvent:s}=this.domEvents,{_eid:r}=n,{_eid:a}=i;let d=!1;const{event:o,start:u}=s,y=this.isDOMElementAnEvent(e.target),D=t.mousedUp;if(t.mousedUp=!1,y&&(this.domEvents.cancelClickEventCreation=!0),l.eventCreated)return;if(a){const{originalEnd:k,originalEndTimeMinutes:W,endTimeMinutes:I}=i,x=this.view.events.find(m=>m._eid===i._eid);if(d=I&&I!==W,x&&x.end.getTime()!==k.getTime()){const m=this.mutableEvents.find(F=>F._eid===i._eid);m.endTimeMinutes=x.endTimeMinutes,m.end=x.end;const p=this.cleanupEvent(x),E={...this.cleanupEvent(x),end:k,endTimeMinutes:x.originalEndTimeMinutes};this.$emit('event-duration-change',{event:p,oldDate:i.originalEnd,originalEvent:E}),this.$emit('event-change',{event:p,originalEvent:E});}x&&(x.resizing=!1),i._eid=null,i.start=null,i.split=null,i.segment=null,i.originalEndTimeMinutes=null,i.originalEnd=null,i.endTimeMinutes=null,i.startCell=null,i.endCell=null;}else u&&(o&&(this.emitWithEvent('event-drag-create',o),s.event.resizing=!1),s.start=null,s.split=null,s.event=null);y||a||this.unfocusEvent(),n.timeoutId&&!r&&(clearTimeout(n.timeoutId),n.timeoutId=null),l.timeoutId&&(clearTimeout(l.timeoutId),l.timeoutId=null);const A=typeof this.onEventClick=='function';if(D&&!d&&!r&&!o&&A){let k=this.view.events.find(W=>W._eid===t._eid);return!k&&this.isMonthView&&(k=this.view.outOfScopeEvents.find(W=>W._eid===t._eid)),k&&this.onEventClick(k,e);}},onKeyUp(e){e.keyCode===27&&this.cancelDelete();},eventResizing(e){const{resizeAnEvent:t}=this.domEvents,i=this.view.events.find(o=>o._eid===t._eid)||{segments:{}},{minutes:n,cursorCoords:l}=this.minutesAtCursor(e),s=i.segments&&i.segments[t.segment],{date:r,event:a}=this.utils,d=Math.max(n,this.timeFrom+1,(s||i).startTimeMinutes+1);if(i.endTimeMinutes=t.endTimeMinutes=d,this.snapToTime){const o=i.endTimeMinutes+this.snapToTime/2;i.endTimeMinutes=o-o%this.snapToTime;}if(s&&(s.endTimeMinutes=i.endTimeMinutes),i.end.setHours(0,i.endTimeMinutes,i.endTimeMinutes===1440?-1:0,0),this.resizeX&&this.isWeekView){i.daysCount=r.countDays(i.start,i.end);const o=this.cellsEl,u=o.offsetWidth/o.childElementCount,y=Math.floor(l.x/u);if(t.startCell===null&&(t.startCell=y-(i.daysCount-1)),t.endCell!==y){t.endCell=y;const D=r.addDays(i.start,y-t.startCell),A=Math.max(r.countDays(i.start,D),1);if(A!==i.daysCount){let k=null;k=A>i.daysCount?a.addEventSegment(i):a.removeEventSegment(i),t.segment=k,i.endTimeMinutes+=.001;}}}this.$emit('event-resizing',{_eid:i._eid,end:i.end,endTimeMinutes:i.endTimeMinutes});},eventDragCreation(e){const{dragCreateAnEvent:t}=this.domEvents,{start:i,startCursorY:n,split:l}=t,s=new Date(i),{minutes:r,cursorCoords:{y:a}}=this.minutesAtCursor(e);if(t.event||!(Math.abs(n-a)<this.dragToCreateThreshold))if(t.event){if(s.setHours(0,r,r===1440?-1:0,0),this.snapToTime){let u=60*s.getHours()+s.getMinutes();const y=u+this.snapToTime/2;u=y-y%this.snapToTime,s.setHours(0,u,0,0);}const d=i<s,{event:o}=t;o.start=d?i:s,o.end=d?s:i,o.startTimeMinutes=60*o.start.getHours()+o.start.getMinutes(),o.endTimeMinutes=60*o.end.getHours()+o.end.getMinutes();}else{if(t.event=this.utils.event.createAnEvent(i,1,{split:l}),!t.event)return t.start=null,t.split=null,void(t.event=null);t.event.resizing=!0;}},unfocusEvent(){const{focusAnEvent:e,clickHoldAnEvent:t}=this.domEvents,i=this.view.events.find(n=>n._eid===(e._eid||t._eid));e._eid=null,t._eid=null,i&&(i.focused=!1,i.deleting=!1);},cancelDelete(){const{clickHoldAnEvent:e}=this.domEvents;if(e._eid){const t=this.view.events.find(i=>i._eid===e._eid);t&&(t.deleting=!1),e._eid=null,e.timeoutId=null;}},onEventTitleBlur(e,t){if(t.title===e.target.innerHTML)return;const i=t.title;t.title=e.target.innerHTML;const n=this.cleanupEvent(t);this.$emit('event-title-change',{event:n,oldTitle:i}),this.$emit('event-change',{event:n,originalEvent:{...n,title:i}});},updateMutableEvents(){const e=this.utils.date;this.mutableEvents=[],this.events.forEach(t=>{const i=typeof t.start=='string'?e.stringToDate(t.start):t.start,n=e.formatDateLite(i),l=e.dateToMinutes(i);let s=null;typeof t.end=='string'&&t.end.includes('24:00')?(s=new Date(t.end.replace(' 24:00','')),s.setHours(23,59,59,0)):s=typeof t.end=='string'?e.stringToDate(t.end):t.end;let r=e.formatDateLite(s),a=e.dateToMinutes(s);a&&a!==1440||(!this.time||typeof t.end=='string'&&t.end.length===10?s.setHours(23,59,59,0):s.setSeconds(s.getSeconds()-1),r=e.formatDateLite(s),a=1440);const d=n!==r;t=Object.assign({...this.utils.event.eventDefaults},t,{_eid:`${this._.uid}_${this.eventIdIncrement++}`,segments:d?{}:null,start:i,startTimeMinutes:l,end:s,endTimeMinutes:a,daysCount:d?e.countDays(i,s):1,class:t.class}),this.mutableEvents.push(t);});},minutesAtCursor(e){return this.utils.cell.minutesAtCursor(e);},createEvent(e,t,i={}){return this.utils.event.createAnEvent(e,t,i);},cleanupEvent(e){return e={...e},['segments','deletable','deleting','titleEditable','resizable','resizing','draggable','dragging','draggingStatic','focused'].forEach(t=>{t in e&&delete e[t];}),e.repeat||delete e.repeat,e;},emitWithEvent(e,t){this.$emit(e,this.cleanupEvent(t));},updateSelectedDate(e){if((e=e&&typeof e=='string'?this.utils.date.stringToDate(e):new Date(e))&&e instanceof Date){const{selectedDate:t}=this.view;t&&(this.transitionDirection=t.getTime()>e.getTime()?'left':'right'),e.setHours(0,0,0,0),t&&t.getTime()===e.getTime()||(this.view.selectedDate=e),this.switchView(this.view.id);}this.$emit('update:selected-date',this.view.selectedDate);},getWeekNumber(e){const t=this.utils.date,i=this.firstCellDateWeekNumber+e,n=this.startWeekOnSunday?1:0;return i>52?t.getWeek(t.addDays(this.view.firstCellDate,7*e+n)):i;},timeTick(){this.now=new Date,this.timeTickerIds[1]=setTimeout(this.timeTick,6e4);},updateDateTexts(){this.utils.date.updateTexts(this.texts);},alignWithScrollbar(){if(document.getElementById('vuecal-align-with-scrollbar'))return;const e=this.$refs.vuecal.getElementsByClassName('vuecal__scrollbar-check')[0],t=e.offsetWidth-e.children[0].offsetWidth;if(t){const i=document.createElement('style');i.id='vuecal-align-with-scrollbar',i.type='text/css',i.innerHTML=`.vuecal--view-with-time .vuecal__weekdays-headings,.vuecal--view-with-time .vuecal__all-day {padding-right: ${t}px}`,document.head.appendChild(i);}},cellOrSplitHasEvents:(e,t=null)=>e.length&&(!t&&e.length||t&&e.some(i=>i.split===t.id))},created(){this.utils.cell=new ct(this),this.utils.event=new vt(this,this.utils.date),this.loadLocale(this.locale),this.editEvents.drag&&this.loadDragAndDrop(),this.updateMutableEvents(this.events),this.view.id=this.currentView,this.selectedDate?this.updateSelectedDate(this.selectedDate):(this.view.selectedDate=new Date,this.switchView(this.currentView)),this.time&&this.watchRealTime&&(this.timeTickerIds[0]=setTimeout(this.timeTick,1e3*(60-this.now.getSeconds())));},mounted(){const e=this.utils.date,t='ontouchstart'in window,{resize:i,drag:n,create:l,delete:s,title:r}=this.editEvents,a=this.onEventClick&&typeof this.onEventClick=='function';(i||n||l||s||r||a)&&window.addEventListener(t?'touchend':'mouseup',this.onMouseUp),(i||n||l&&this.dragToCreateEvent)&&window.addEventListener(t?'touchmove':'mousemove',this.onMouseMove,{passive:!1}),r&&window.addEventListener('keyup',this.onKeyUp),t&&(this.$refs.vuecal.oncontextmenu=function(u){u.preventDefault(),u.stopPropagation();}),this.hideBody||this.alignWithScrollbar();const d=this.view.startDate,o={view:this.view.id,startDate:d,endDate:this.view.endDate,...this.isMonthView?{firstCellDate:this.view.firstCellDate,lastCellDate:this.view.lastCellDate}:{},events:this.view.events.map(this.cleanupEvent),...this.isWeekView?{week:e.getWeek(this.startWeekOnSunday?e.addDays(d,1):d)}:{}};this.$emit('ready',o),this.ready=!0;},beforeUnmount(){const e='ontouchstart'in window;window.removeEventListener(e?'touchmove':'mousemove',this.onMouseMove,{passive:!1}),window.removeEventListener(e?'touchend':'mouseup',this.onMouseUp),window.removeEventListener('keyup',this.onKeyUp),this.timeTickerIds[0]&&clearTimeout(this.timeTickerIds[0]),this.timeTickerIds[1]&&clearTimeout(this.timeTickerIds[1]),this.timeTickerIds=[null,null];},computed:{editEvents(){return this.editableEvents&&typeof this.editableEvents=='object'?{title:!!this.editableEvents.title,drag:!!this.editableEvents.drag,resize:!!this.editableEvents.resize,create:!!this.editableEvents.create,delete:!!this.editableEvents.delete}:{title:!!this.editableEvents,drag:!!this.editableEvents,resize:!!this.editableEvents,create:!!this.editableEvents,delete:!!this.editableEvents};},views(){return{years:{label:this.texts.years,enabled:!this.disableViews.includes('years')},year:{label:this.texts.year,enabled:!this.disableViews.includes('year')},month:{label:this.texts.month,enabled:!this.disableViews.includes('month')},week:{label:this.texts.week,enabled:!this.disableViews.includes('week')},day:{label:this.texts.day,enabled:!this.disableViews.includes('day')}};},currentView(){return this.validateView(this.activeView);},enabledViews(){return Object.keys(this.views).filter(e=>this.views[e].enabled);},hasTimeColumn(){return this.time&&this.isWeekOrDayView;},isShortMonthView(){return this.isMonthView&&this.eventsOnMonthView==='short';},firstCellDateWeekNumber(){const e=this.utils.date,t=this.view.firstCellDate;return e.getWeek(this.startWeekOnSunday?e.addDays(t,1):t);},timeCells(){const e=[];for(let t=this.timeFrom,i=this.timeTo;t<i;t+=this.timeStep)e.push({hours:Math.floor(t/60),minutes:t%60,label:this.utils.date.formatTime(t,this.TimeFormat),value:t});return e;},TimeFormat(){return this.timeFormat||(this.twelveHour?'h:mm{am}':'HH:mm');},daySplits(){return(this.splitDays.filter(e=>!e.hide)||[]).map((e,t)=>({...e,id:e.id||t+1}));},hasSplits(){return this.daySplits.length&&this.isWeekOrDayView;},hasShortEvents(){return this.showAllDayEvents==='short';},cellOrSplitMinWidth(){let e=null;return this.hasSplits&&this.minSplitWidth?e=this.visibleDaysCount*this.minSplitWidth*this.daySplits.length:this.minCellWidth&&this.isWeekView&&(e=this.visibleDaysCount*this.minCellWidth),e;},allDayBar(){let e=this.allDayBarHeight||null;return e&&!isNaN(e)&&(e+='px'),{cells:this.viewCells,options:this.$props,label:this.texts.allDay,shortEvents:this.hasShortEvents,daySplits:this.hasSplits&&this.daySplits||[],cellOrSplitMinWidth:this.cellOrSplitMinWidth,height:e};},minTimestamp(){let e=null;return this.minDate&&typeof this.minDate=='string'?e=this.utils.date.stringToDate(this.minDate):this.minDate&&this.minDate instanceof Date&&(e=this.minDate),e?e.getTime():null;},maxTimestamp(){let e=null;return this.maxDate&&typeof this.maxDate=='string'?e=this.utils.date.stringToDate(this.maxDate):this.maxDate&&this.minDate instanceof Date&&(e=this.maxDate),e?e.getTime():null;},weekDays(){let{weekDays:e,weekDaysShort:t=[]}=this.texts;return e=e.slice(0).map((i,n)=>({label:i,...t.length?{short:t[n]}:{},hide:this.hideWeekends&&n>=5||this.hideWeekdays.length&&this.hideWeekdays.includes(n+1)})),this.startWeekOnSunday&&e.unshift(e.pop()),e;},weekDaysInHeader(){return this.isMonthView||this.isWeekView&&!this.minCellWidth&&!(this.hasSplits&&this.minSplitWidth);},months(){return this.texts.months.map(e=>({label:e}));},specialDayHours(){return this.specialHours&&Object.keys(this.specialHours).length?Array(7).fill('').map((e,t)=>{let i=this.specialHours[t+1]||[];return Array.isArray(i)||(i=[i]),e=[],i.forEach(({from:n,to:l,class:s,label:r},a)=>{e[a]={day:t+1,from:[null,void 0].includes(n)?null:1*n,to:[null,void 0].includes(l)?null:1*l,class:s||'',label:r||''};}),e;}):{};},viewTitle(){const e=this.utils.date;let t='';const i=this.view.startDate,n=i.getFullYear(),l=i.getMonth();switch(this.view.id){case'years':t=this.texts.years;break;case'year':t=n;break;case'month':t=`${this.months[l].label} ${n}`;break;case'week':{const s=this.view.endDate,r=i.getFullYear();let a=this.texts.months[i.getMonth()];this.xsmall&&(a=a.substring(0,3));let d=`${a} ${r}`;if(s.getMonth()!==i.getMonth()){const o=s.getFullYear();let u=this.texts.months[s.getMonth()];this.xsmall&&(u=u.substring(0,3)),d=r===o?`${a} - ${u} ${r}`:this.small?`${a.substring(0,3)} ${r} - ${u.substring(0,3)} ${o}`:`${a} ${r} - ${u} ${o}`;}t=`${this.texts.week} ${e.getWeek(this.startWeekOnSunday?e.addDays(i,1):i)} (${d})`;break;}case'day':t=this.utils.date.formatDate(i,this.texts.dateFormat,this.texts);}return t;},viewCells(){const e=this.utils.date;let t=[],i=null,n=!1;this.watchRealTime||(this.now=new Date);const l=this.now;switch(this.view.id){case'years':i=this.view.startDate.getFullYear(),t=Array.apply(null,Array(25)).map((s,r)=>{const a=new Date(i+r,0,1),d=new Date(i+r+1,0,1);return d.setSeconds(-1),{startDate:a,formattedDate:e.formatDateLite(a),endDate:d,content:i+r,current:i+r===l.getFullYear()};});break;case'year':i=this.view.startDate.getFullYear(),t=Array.apply(null,Array(12)).map((s,r)=>{const a=new Date(i,r,1),d=new Date(i,r+1,1);return d.setSeconds(-1),{startDate:a,formattedDate:e.formatDateLite(a),endDate:d,content:this.xsmall?this.months[r].label.substr(0,3):this.months[r].label,current:r===l.getMonth()&&i===l.getFullYear()};});break;case'month':{const s=this.view.startDate.getMonth(),r=new Date(this.view.firstCellDate);n=!1,t=Array.apply(null,Array(42)).map((a,d)=>{const o=e.addDays(r,d),u=new Date(o);u.setHours(23,59,59,0);const y=!n&&e.isToday(o)&&!n++;return{startDate:o,formattedDate:e.formatDateLite(o),endDate:u,content:o.getDate(),today:y,outOfScope:o.getMonth()!==s,class:`vuecal__cell--day${o.getDay()||7}`};}),(this.hideWeekends||this.hideWeekdays.length)&&(t=t.filter(a=>{const d=a.startDate.getDay()||7;return!(this.hideWeekends&&d>=6||this.hideWeekdays.length&&this.hideWeekdays.includes(d));}));break;}case'week':{n=!1;const s=this.view.startDate,r=this.weekDays;t=r.map((a,d)=>{const o=e.addDays(s,this.startWeekOnSunday?d-1:d),u=new Date(o);u.setHours(23,59,59,0);const y=(o.getDay()||7)-1;return{startDate:o,formattedDate:e.formatDateLite(o),endDate:u,today:!n&&e.isToday(o)&&!n++,specialHours:this.specialDayHours[y]||[]};}).filter((a,d)=>!r[d].hide);break;}case'day':{const s=this.view.startDate,r=new Date(this.view.startDate);r.setHours(23,59,59,0);const a=(s.getDay()||7)-1;t=[{startDate:s,formattedDate:e.formatDateLite(s),endDate:r,today:e.isToday(s),specialHours:this.specialDayHours[a]||[]}];break;}}return t;},visibleDaysCount(){return this.isDayView?1:7-this.weekDays.reduce((e,t)=>e+t.hide,0);},cellWidth(){return 100/this.visibleDaysCount;},cssClasses(){const{resizeAnEvent:e,dragAnEvent:t,dragCreateAnEvent:i}=this.domEvents;return{[`vuecal--${this.view.id}-view`]:!0,[`vuecal--${this.locale}`]:this.locale,'vuecal--no-time':!this.time,'vuecal--view-with-time':this.hasTimeColumn,'vuecal--week-numbers':this.showWeekNumbers&&this.isMonthView,'vuecal--twelve-hour':this.twelveHour,'vuecal--click-to-navigate':this.clickToNavigate,'vuecal--hide-weekends':this.hideWeekends,'vuecal--split-days':this.hasSplits,'vuecal--sticky-split-labels':this.hasSplits&&this.stickySplitLabels,'vuecal--overflow-x':this.minCellWidth&&this.isWeekView||this.hasSplits&&this.minSplitWidth,'vuecal--small':this.small,'vuecal--xsmall':this.xsmall,'vuecal--resizing-event':e._eid,'vuecal--drag-creating-event':i.event,'vuecal--dragging-event':t._eid,'vuecal--events-on-month-view':this.eventsOnMonthView,'vuecal--short-events':this.isMonthView&&this.eventsOnMonthView==='short','vuecal--has-touch':typeof window<'u'&&'ontouchstart'in window};},isYearsOrYearView(){return['years','year'].includes(this.view.id);},isYearsView(){return this.view.id==='years';},isYearView(){return this.view.id==='year';},isMonthView(){return this.view.id==='month';},isWeekOrDayView(){return['week','day'].includes(this.view.id);},isWeekView(){return this.view.id==='week';},isDayView(){return this.view.id==='day';}},watch:{events:{handler(e,t){this.updateMutableEvents(e),this.addEventsToView();},deep:!0},locale(e){this.loadLocale(e);},selectedDate(e){this.updateSelectedDate(e);},activeView(e){this.switchView(e);}}},wi=G(pi,[['render',function(e,t,i,n,l,s){const r=q('vuecal-header'),a=q('all-day-bar'),d=q('weekdays-headings'),o=q('vuecal-cell');return c(),v('div',{class:L(['vuecal__flex vuecal',s.cssClasses]),column:'',ref:'vuecal',lang:i.locale},[O(r,{options:e.$props,'edit-events':s.editEvents,'view-props':{views:s.views,weekDaysInHeader:s.weekDaysInHeader},'week-days':s.weekDays,'has-splits':s.hasSplits,'day-splits':s.daySplits,'switch-to-narrower-view':s.switchToNarrowerView},me({'arrow-prev':g(()=>[f(e.$slots,'arrow-prev',{},()=>[j('Â '),Ft,j('Â ')])]),'arrow-next':g(()=>[f(e.$slots,'arrow-next',{},()=>[j('Â '),Pt,j('Â ')])]),'today-button':g(()=>[f(e.$slots,'today-button',{},()=>[S('span',Rt,T(l.texts.today),1)])]),title:g(()=>[f(e.$slots,'title',{title:s.viewTitle,view:l.view},()=>[j(T(s.viewTitle),1)])]),_:2},[e.$slots['weekday-heading']?{name:'weekday-heading',fn:g(({heading:u,view:y})=>[f(e.$slots,'weekday-heading',{heading:u,view:y})]),key:'0'}:void 0,e.$slots['split-label']?{name:'split-label',fn:g(({split:u})=>[f(e.$slots,'split-label',{split:u,view:l.view.id})]),key:'1'}:void 0]),1032,['options','edit-events','view-props','week-days','has-splits','day-splits','switch-to-narrower-view']),i.hideBody?_('',!0):(c(),v('div',Nt,[O(oe,{name:`slide-fade--${l.transitionDirection}`,appear:i.transitions},{default:g(()=>[(c(),v('div',{class:'vuecal__flex',style:{'min-width':'100%'},key:!!i.transitions&&l.view.id,column:''},[i.showAllDayEvents&&s.hasTimeColumn&&(!s.cellOrSplitMinWidth||s.isDayView&&!i.minSplitWidth)?(c(),P(a,fe(Ee({key:0},s.allDayBar)),{event:g(({event:u,view:y})=>[f(e.$slots,'event',{view:y,event:u},()=>[s.editEvents.title&&u.titleEditable?(c(),v('div',{key:0,class:'vuecal__event-title vuecal__event-title--edit',contenteditable:'',onBlur:D=>s.onEventTitleBlur(D,u),innerHTML:u.title},null,40,Bt)):u.title?(c(),v('div',{key:1,class:'vuecal__event-title',innerHTML:u.title},null,8,zt)):_('',!0),!u.content||s.hasShortEvents||s.isShortMonthView?_('',!0):(c(),v('div',{key:2,class:'vuecal__event-content',innerHTML:u.content},null,8,Ut))])]),_:3},16)):_('',!0),S('div',{class:L(['vuecal__bg',{vuecal__flex:!s.hasTimeColumn}]),column:''},[S('div',qt,[s.hasTimeColumn?(c(),v('div',Kt,[i.showAllDayEvents&&s.cellOrSplitMinWidth&&(!s.isDayView||i.minSplitWidth)?(c(),v('div',{key:0,class:'vuecal__all-day-text',style:B({height:s.allDayBar.height})},[S('span',null,T(l.texts.allDay),1)],4)):_('',!0),(c(!0),v(H,null,R(s.timeCells,(u,y)=>(c(),v('div',{class:'vuecal__time-cell',key:y,style:B(`height: ${i.timeCellHeight}px`)},[f(e.$slots,'time-cell',{hours:u.hours,minutes:u.minutes},()=>[Xt,S('span',Gt,T(u.label),1)])],4))),128))])):_('',!0),i.showWeekNumbers&&s.isMonthView?(c(),v('div',Zt,[(c(),v(H,null,R(6,u=>S('div',{class:'vuecal__flex vuecal__week-number-cell',key:u,grow:''},[f(e.$slots,'week-number-cell',{week:s.getWeekNumber(u-1)},()=>[j(T(s.getWeekNumber(u-1)),1)])])),64))])):_('',!0),S('div',{class:L(['vuecal__flex vuecal__cells',`${l.view.id}-view`]),grow:'',wrap:!s.cellOrSplitMinWidth||!s.isWeekView,column:!!s.cellOrSplitMinWidth},[s.cellOrSplitMinWidth&&s.isWeekView?(c(),P(d,{key:0,'transition-direction':l.transitionDirection,'week-days':s.weekDays,'switch-to-narrower-view':s.switchToNarrowerView,style:B(s.cellOrSplitMinWidth?`min-width: ${s.cellOrSplitMinWidth}px`:'')},me({_:2},[e.$slots['weekday-heading']?{name:'weekday-heading',fn:g(({heading:u,view:y})=>[f(e.$slots,'weekday-heading',{heading:u,view:y})]),key:'0'}:void 0,e.$slots['split-label']?{name:'split-label',fn:g(({split:u})=>[f(e.$slots,'split-label',{split:u,view:l.view.id})]),key:'1'}:void 0]),1032,['transition-direction','week-days','switch-to-narrower-view','style'])):s.hasSplits&&i.stickySplitLabels&&i.minSplitWidth?(c(),v('div',{key:1,class:'vuecal__flex vuecal__split-days-headers',style:B(s.cellOrSplitMinWidth?`min-width: ${s.cellOrSplitMinWidth}px`:'')},[(c(!0),v(H,null,R(s.daySplits,(u,y)=>(c(),v('div',{class:L(['day-split-header',u.class||!1]),key:y},[f(e.$slots,'split-label',{split:u,view:l.view.id},()=>[j(T(u.label),1)])],2))),128))],4)):_('',!0),i.showAllDayEvents&&s.hasTimeColumn&&(s.isWeekView&&s.cellOrSplitMinWidth||s.isDayView&&s.hasSplits&&i.minSplitWidth)?(c(),P(a,fe(Ee({key:2},s.allDayBar)),{event:g(({event:u,view:y})=>[f(e.$slots,'event',{view:y,event:u},()=>[s.editEvents.title&&u.titleEditable?(c(),v('div',{key:0,class:'vuecal__event-title vuecal__event-title--edit',contenteditable:'',onBlur:D=>s.onEventTitleBlur(D,u),innerHTML:u.title},null,40,Qt)):u.title?(c(),v('div',{key:1,class:'vuecal__event-title',innerHTML:u.title},null,8,ei)):_('',!0),!u.content||s.hasShortEvents||s.isShortMonthView?_('',!0):(c(),v('div',{key:2,class:'vuecal__event-content',innerHTML:u.content},null,8,ti))])]),_:3},16)):_('',!0),S('div',{class:'vuecal__flex',ref:u=>l.cellsEl=u,grow:'',wrap:!s.cellOrSplitMinWidth||!s.isWeekView,style:B(s.cellOrSplitMinWidth?`min-width: ${s.cellOrSplitMinWidth}px`:'')},[(c(!0),v(H,null,R(s.viewCells,(u,y)=>(c(),P(o,{key:y,options:e.$props,'edit-events':s.editEvents,data:u,'cell-width':i.hideWeekdays.length&&(s.isWeekView||s.isMonthView)&&s.cellWidth,'min-timestamp':s.minTimestamp,'max-timestamp':s.maxTimestamp,'cell-splits':s.hasSplits&&s.daySplits||[]},{'cell-content':g(({events:D,split:A,selectCell:k})=>[f(e.$slots,'cell-content',{cell:u,view:l.view,goNarrower:k,events:D},()=>[A&&!i.stickySplitLabels?(c(),v('div',{key:0,class:'split-label',innerHTML:A.label},null,8,si)):_('',!0),u.content?(c(),v('div',{key:1,class:'vuecal__cell-date',innerHTML:u.content},null,8,ni)):_('',!0),(s.isMonthView&&!i.eventsOnMonthView||s.isYearsOrYearView&&i.eventsCountOnYearView)&&D.length?(c(),v('div',ai,[f(e.$slots,'events-count',{view:l.view,events:D},()=>[j(T(D.length),1)])])):_('',!0),!s.cellOrSplitHasEvents(D,A)&&s.isWeekOrDayView?(c(),v('div',li,[f(e.$slots,'no-event',{},()=>[j(T(l.texts.noEvent),1)])])):_('',!0)])]),event:g(({event:D,view:A})=>[f(e.$slots,'event',{view:A,event:D},()=>[s.editEvents.title&&D.titleEditable?(c(),v('div',{key:0,class:'vuecal__event-title vuecal__event-title--edit',contenteditable:'',onBlur:k=>s.onEventTitleBlur(k,D),innerHTML:D.title},null,40,ri)):D.title?(c(),v('div',{key:1,class:'vuecal__event-title',innerHTML:D.title},null,8,oi)):_('',!0),!i.time||D.allDay||s.isMonthView&&(D.allDay||i.showAllDayEvents==='short')||s.isShortMonthView?_('',!0):(c(),v('div',di,[j(T(l.utils.date.formatTime(D.start,s.TimeFormat)),1),D.endTimeMinutes?(c(),v('span',ui,'Â - '+T(l.utils.date.formatTime(D.end,s.TimeFormat,null,!0)),1)):_('',!0),D.daysCount>1&&(D.segments[u.formattedDate]||{}).isFirstDay?(c(),v('small',ci,'Â +'+T(D.daysCount-1)+T((l.texts.day[0]||'').toLowerCase()),1)):_('',!0)])),!D.content||s.isMonthView&&D.allDay&&i.showAllDayEvents==='short'||s.isShortMonthView?_('',!0):(c(),v('div',{key:3,class:'vuecal__event-content',innerHTML:D.content},null,8,vi))])]),'no-event':g(()=>[f(e.$slots,'no-event',{},()=>[j(T(l.texts.noEvent),1)])]),_:2},1032,['options','edit-events','data','cell-width','min-timestamp','max-timestamp','cell-splits']))),128))],12,ii)],10,Jt)])],2)]))]),_:3},8,['name','appear']),l.ready?_('',!0):(c(),v('div',hi,mi))]))],10,Yt);}]]),yi={key:0},Di=de({__name:'CalendarCell',props:{vuecal:{type:Object,default:null},event:{type:Object,default:()=>{}}},setup(e){const t=e,i=De(),n=ye(),l=Y(()=>xe(t.event.start,t.event.end)),s=a=>{n.addOrUpdate(a).then(()=>{i.addActivityId(a._id),i.removeNewEvent();});},r=a=>{s(a);};return(a,d)=>(c(),v(H,null,[O(Ze,{class:L(['calendar-cell__title',{'calendar-cell__title--new':!t.event.title}])},{default:g(()=>[t.event.title?(c(),v('span',yi,T(t.event.title),1)):(c(),P(Ge,{key:1,class:'mb-1',event:l.value,focused:!0,'search-options':{archived:!1},onNewClick:r,onOptionClick:s,onOnEscape:$e(i).removeNewEvent},null,8,['event','onOnEscape']))]),_:1},8,['class']),O(Je,null,{default:g(()=>[j(T(l.value.start.formatTime('hh:mm')+' - '+l.value.end.formatTime('hh:mm')),1)]),_:1})],64));}});const _i=de({__name:'CalendarMain',props:{vuecal:{type:Object,default:null},activeView:{type:String,default:'week'},selectedDate:{type:Date,default:void 0},views:{type:Array,default:()=>[]}},emits:['update:activeView','addEvent','updateEvent','fetchEvents'],setup(e,{emit:t}){const i=e,n=re(null),l=De(),s=He();pe(()=>s.isRightSidebarVisible,h=>{h===!1&&I();}),pe(()=>i.selectedDate,()=>{E();});const r=Y(()=>({title:!1,drag:!0,resize:!0,delete:!1,create:!ue.value.mobile.value})),a=Y(()=>i.vuecal?l.events:[]),d=Y(()=>i.vuecal?i.views?Le.filter(h=>!i.views.includes(h)):[]:[]),o=Y(()=>['week','day'].includes(i.activeView)?80:40),u=h=>{l.focusCell(h),y(),i.vuecal.mutableEvents.findIndex($=>h>=$.start&&$.end&&h<=$.end)===-1&&l.removeNewEvent();},y=()=>{l.unfocusEvent(),s.hideRightSidebar();},D=h=>{h.eventId===l.focusedEvent?.eventId&&s.showRightSidebar(h.id,h.eventId),l.focusEvent(h.eventId),h.id&&I();},A=h=>{const b=We.calendar.snapDifference,$=le(z(),h.start);if($<b&&$>-b)return h.start=z(),h;if(h.end){const V=le(z(),h.end);if(V<b&&V>-b)return h.end=z(),h;}const J=i.vuecal.mutableEvents.find(V=>V.id?.toString()!==h.id&&h.end&&V.start<=h.end&&V.end>=h.end);if(J&&h.end){const V=le(J.start,h.end);if(V<b&&V>-b)return h.start=be(h.start,-V),h.end=J.start,h;}const Q=i.vuecal.mutableEvents.find(V=>V.id?.toString()!==h.id&&V.start<=h.start&&V.end>=h.start);if(Q&&h.end){const V=le(Q.end,h.start);if(V<b&&V>-b)return h.end=be(h.end,V),h.start=Q.end,h;}return h;},k=h=>{W(h);},W=h=>{if(!h.event.eventId)return;const b=A(h.event);return t('updateEvent',b.id,{id:b.eventId,start:b.start,end:b.end},b.repeatIteration),!0;},I=h=>{i.vuecal.mutableEvents.forEach(b=>{b.id||h!==b.start&&(i.vuecal.emitWithEvent('event-delete',b),n.value&&(n.value.mutableEvents=i.vuecal.mutableEvents.filter($=>$._eid!==b._eid),n.value.view.events=i.vuecal.view.events.filter($=>$._eid!==b._eid)));});},x=h=>{h.view&&i.vuecal&&t('update:activeView',h.view),t('fetchEvents',h.startDate,h.endDate);},m=h=>{if(ue.value.mobile.value)return;if(l.focusedEvent||-1<l.events.findIndex($=>$.start<=h&&(!$.end||$.end>=h)))return!1;t('addEvent',h);},p=()=>{if(!ue.value.mobile.value||!i.vuecal)return;const h=document.querySelector('.calendar .vuecal__bg'),b=document.querySelectorAll('.calendar .vuecal__bg .vuecal__cell');b&&b.forEach(($,J)=>{const Q=structuredClone(i.vuecal.viewCells[J]);$.addEventListener('touchstart',V=>{const Fe=h?.scrollTop,Pe=setTimeout(()=>{if(Fe!==h?.scrollTop)return;const Re=Q.startDate.addMinutes(i.vuecal.utils.cell.minutesAtCursor(V).minutes);t('addEvent',Re);},800);$.addEventListener('touchend',()=>{clearTimeout(Pe);});});});},E=()=>{if(!i.vuecal)return;const h=document.querySelector('.calendar .vuecal__body');h&&h.scrollTo({top:z().getHours()*i.vuecal.timeCellHeight});},F=h=>{Qe(()=>{x(h),E(),p();});},Z=h=>{const b=A(h);t('addEvent',b.start,b.end);};return(h,b)=>(c(),P($e(wi),{ref_key:'vuecalRef',ref:n,style:{height:'calc(100vh - 8px - 16px - 72px - 80px)'},'selected-date':e.selectedDate,class:'v-card calendar','active-view':e.activeView,'disable-views':d.value,events:a.value,'click-to-navigate':!1,'dblclick-to-navigate':['year','month'].includes(e.activeView),'snap-to-time':15,'hide-view-selector':'','hide-title-bar':'','watch-realtime':'true','show-all-day-events':!0,'editable-events':r.value,'events-on-month-view':'short','time-cell-height':o.value,'watch-real-time':!0,onEventClick:D,onCellClick:u,onCellDblclick:m,onReady:F,onViewChange:x,onEventDurationChange:W,onEventDrop:k,onEventDragCreate:Z},{event:g(({event:$})=>[O(Di,{event:$},null,8,['event'])]),_:1},8,['selected-date','active-view','disable-views','events','dblclick-to-navigate','editable-events','time-cell-height']));}});const fi=de({__name:'Calendar',setup(e){const t=Y(()=>structuredClone(Le).filter(m=>m!=='years')),i=()=>{const m=te.currentRoute.value.query.view?.toString()??Ie;return t.value.includes(m)?m:Me;},n=De(),l=ye(),s=He(),r=ke(),a=re(i()),d=re(null);pe(t,m=>{m.includes(a.value)||(a.value=Me);});const o=Y(()=>{if(!te.currentRoute.value.query.date)return z();const m=z(parseInt(te.currentRoute.value.query.date));return ce(m)?m:z();}),u=Y(()=>{if(d.value)return d.value.$refs.vuecalRef;}),y=m=>{D(m),A(m);},D=m=>{if(m.key==='Escape'){n.unfocusEvent(),s.hideRightSidebar();return;}!m.ctrlKey&&!m.metaKey||(m.key==='v'&&n.clipboard&&n.focusedCell&&ce(n.focusedCell)&&l.get(n.clipboard.activityId).then(p=>{if(!p)return;const E=tt(p,n.clipboard.eventId);if(!E||!E.start)return;if(!E.end){ke().addNotice({type:Te.Info,title:Ce('Could not paste in progress event.')});return;}const F=n.focusedCell,Z=F.addMinutes(it(E.end,E.start));l.update(st(p,xe(F,Z))).then(()=>{n.removeFromClipboard();});}),n?.focusedEvent?.eventId&&n?.focusedEvent?.id&&(m.key==='c'&&n.addToClipboard(n.focusedEvent.id,n.focusedEvent.eventId,we.Copy),m.key==='x'&&n.addToClipboard(n.focusedEvent.id,n.focusedEvent.eventId,we.Cut)));},A=m=>{n?.focusedEvent?.eventId&&n?.focusedEvent?.id&&m.key==='Backspace'&&k(n.focusedEvent.id,n.focusedEvent.eventId);},k=(m,p)=>{l.get(m).then(E=>{if(E){if(E.readonly){r.addNotice({type:Te.Warning,title:Ce('Cannot delete readonly event.')});return;}l.update(nt(E,p));}});},W=(m,p,E=!1)=>{l.get(m).then(F=>{F&&l.update(at(F,p,E));});},I=(m,p)=>{m||(m=z()),p||(p=m.addMinutes(We.defaultEventDurationInMinutes)),n.addNewEvent({...lt(m,p),class:'v-card calendar-event__new'});},x=(m,p)=>{n.load(m,p),m&&ce(m)&&a.value&&te.push({query:{...te.currentRoute.value.query,date:he(m),view:a.value??'week'}});};return(m,p)=>(c(),P(et,{class:'calendar pa-4',onKeydown:y},{default:g(()=>[O(ot,{'active-view':a.value,'onUpdate:activeView':p[0]||(p[0]=E=>a.value=E),vuecal:u.value,views:t.value,onAddEvent:I},null,8,['active-view','vuecal','views']),O(_i,{ref_key:'vuecalRef',ref:d,'active-view':a.value,'onUpdate:activeView':p[1]||(p[1]=E=>a.value=E),views:t.value,vuecal:u.value,'selected-date':o.value,onAddEvent:I,onUpdateEvent:W,onFetchEvents:x},null,8,['active-view','views','vuecal','selected-date'])]),_:1}));}});export{fi as _};
